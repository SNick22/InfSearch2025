<!DOCTYPE html>
<html lang="ru">

  <head>
    <title>Создание плагинов и переиспользуемых частей в .gradle.kts-файлах и Kotlin extension-функциях &#x2F; Хабр</title>
<meta property="fb:app_id" content="444736788986613">
<meta property="fb:pages" content="472597926099084">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@habr_com">
<meta property="og:site_name" content="Хабр">
<link href="https://habr.com/ru/rss/post/843662/?fl=ru" type="application/rss+xml" title rel="alternate" name="rss">
<link href="https://habr.com/ru/companies/tbank/articles/843662/" rel="canonical" data-hid="e3fa780">
<link rel="image_src" href="https://habrastorage.org/getpro/habr/upload_files/5db/b11/e8b/5dbb11e8b34998877497f928b873049a.jpg" data-hid="2a79c45">
<link rel="amphtml" href="https://habr.com/ru/amp/publications/843662/">
<meta property="og:title" content="Создание плагинов и переиспользуемых частей в .gradle.kts-файлах и Kotlin extension-функциях">
<meta name="twitter:title" content="Создание плагинов и переиспользуемых частей в .gradle.kts-файлах и Kotlin extension-функциях">
<meta name="aiturec:title" content="Создание плагинов и переиспользуемых частей в .gradle.kts-файлах и Kotlin extension-функциях">
<meta name="description" content="Всем привет! На связи Дима Котиков, и мы продолжаем разговор о том, как облегчить себе жизнь и уменьшить Boilerplate в gradle-файлах. В первой части поговорили о том, как подготовиться к созданию...">
<meta itemprop="description" content="Всем привет! На связи Дима Котиков, и мы продолжаем разговор о том, как облегчить себе жизнь и уменьшить Boilerplate в gradle-файлах. В первой части поговорили о том, как подготовиться к созданию...">
<meta property="og:description" content="Всем привет! На связи Дима Котиков, и мы продолжаем разговор о том, как облегчить себе жизнь и уменьшить Boilerplate в gradle-файлах. В первой части поговорили о том, как подготовиться к созданию...">
<meta name="twitter:description" content="Всем привет! На связи Дима Котиков, и мы продолжаем разговор о том, как облегчить себе жизнь и уменьшить Boilerplate в gradle-файлах. В первой части поговорили о том, как подготовиться к созданию...">
<meta property="aiturec:description" content="Всем привет! На связи Дима Котиков, и мы продолжаем разговор о том, как облегчить себе жизнь и уменьшить Boilerplate в gradle-файлах. В первой части поговорили о том, как подготовиться к созданию...">
<meta itemprop="image" content="https://habrastorage.org/getpro/habr/upload_files/5db/b11/e8b/5dbb11e8b34998877497f928b873049a.jpg">
<meta property="og:image" content="https://habrastorage.org/getpro/habr/upload_files/5db/b11/e8b/5dbb11e8b34998877497f928b873049a.jpg">
<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="630">
<meta property="aiturec:image" content="https://habrastorage.org/getpro/habr/upload_files/5db/b11/e8b/5dbb11e8b34998877497f928b873049a.jpg">
<meta name="twitter:image" content="https://habrastorage.org/getpro/habr/upload_files/5db/b11/e8b/5dbb11e8b34998877497f928b873049a.jpg">
<meta property="vk:image" content="https://habrastorage.org/getpro/habr/upload_files/5db/b11/e8b/5dbb11e8b34998877497f928b873049a.jpg?format=vk">
<meta property="vk:image" content="https://habrastorage.org/getpro/habr/upload_files/5db/b11/e8b/5dbb11e8b34998877497f928b873049a.jpg?format=vk">
<meta property="aiturec:item_id" content="843662">
<meta property="aiturec:datetime" content="2024-09-19T07:20:51.000Z">
<meta content="https://habr.com/ru/companies/tbank/articles/843662/" property="og:url">
<meta property="og:type" content="article">
<meta property="og:locale" content="ru_RU">
<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="630">
<meta name="keywords" content="Gradle Convention Plugins, Gradle, Kotlin, Android, Kotlin Multiplatform">
<script type="application/ld+json" data-hid="1e0f0a2">{"@context":"http:\/\/schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/habr.com\/ru\/companies\/tbank\/articles\/843662\/"},"headline":"Создание плагинов и переиспользуемых частей в .gradle.kts-файлах и Kotlin extension-функциях","datePublished":"2024-09-19T10:20:51+03:00","dateModified":"2024-09-27T11:57:14+03:00","author":{"@type":"Person","name":"Дмитрий"},"publisher":{"@type":"Organization","name":"Habr","logo":{"@type":"ImageObject","url":"https:\/\/habrastorage.org\/webt\/a_\/lk\/9m\/a_lk9mjkccjox-zccjrpfolmkmq.png"}},"description":"Всем привет! На связи Дима Котиков, и мы продолжаем разговор о том, как облегчить себе жизнь и уменьшить Boilerplate в gradle-файлах. В первой части поговорили о...","url":"https:\/\/habr.com\/ru\/companies\/tbank\/articles\/843662\/#post-content-body","about":["c_tbank","h_android_dev","h_kotlin","h_gradle","f_develop"],"image":["https:\/\/habr.com\/share\/publication\/843662\/dbfb4b274acfbfd2a8790ea6053ec5bc\/","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/d29\/4ab\/179\/d294ab179d9d24fe32e62ca32ea1d55f.jpg","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/7ac\/297\/fd1\/7ac297fd1b3a47247b11ba16145a2b14.png","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/f07\/5f6\/218\/f075f6218a724ecc783568074bf2ec04.png","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/128\/329\/864\/1283298641429445bee06321cd640616.png","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/67e\/6b6\/5af\/67e6b65afa6ff4c88ce317f7294e02b3.png","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/72d\/8a7\/ab8\/72d8a7ab8a7f76683b75c3a940d3fbad.png","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/7eb\/187\/480\/7eb187480038e6156bc791ff01a0404e.png","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/cc8\/0a7\/c67\/cc80a7c67ea0d645da20e2aa55ba6e18.png","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/215\/080\/76b\/21508076bf5dab60685506dcf5745281.png","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/957\/9f2\/1cf\/9579f21cfaa6d2d8ecd5b7b5f3bb08da.png","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/765\/38b\/ef0\/76538bef03ce53d2dd86ffca7587506f.png","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/32a\/8a7\/c7a\/32a8a7c7a958041bbf56798f91a44462.png","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/b63\/5da\/329\/b635da32904c134daa0d4a7f13b566dc.png","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/997\/bee\/db6\/997beedb64e9c90ab23a028971be7c5f.png","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/e5b\/9e9\/e04\/e5b9e9e04fb4a57d33849ac092e6de9e.png","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/426\/8a3\/c9e\/4268a3c9e5ecb0a3ca7ce3d184f10f74.png","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/4d0\/3a0\/e1f\/4d03a0e1fded8cdf2c18fc891eefb35c.png","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/4ab\/cb9\/6e5\/4abcb96e5f523711de6eb4f5088627ed.png","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/b7a\/5e1\/a17\/b7a5e1a17b1c4f710ef2cafab9c8fb56.png","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/df5\/c33\/b15\/df5c33b15adde3034f2e61ae6d7ad274.png","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/e24\/1ce\/f83\/e241cef83b68ef0cf70545fce2eee3f7.png","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/10f\/e48\/7e4\/10fe487e4328b667e4c97f1b3c08f2f2.png","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/dfd\/7ac\/e76\/dfd7ace76293eda1a2c90156d0341b20.png","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/d4b\/b87\/188\/d4bb87188dc8dfdc68fa5545fa72adfc.png","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/987\/904\/fab\/987904fab133374e7431ec1b0afcb1cd.png","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/0f0\/e8f\/849\/0f0e8f8499fbb080fe359f6a287560c6.png","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/5db\/b11\/e8b\/5dbb11e8b34998877497f928b873049a.jpg"]}</script>
    <meta charset="UTF-8">
    <meta name="viewport"
      content="width=device-width,initial-scale=1.0,viewport-fit=cover,maximum-scale=1,user-scalable=0">
    <meta name="referrer" content="unsafe-url">
    <style>
      /* cyrillic-ext */
      @font-face {
        font-family: 'Fira Sans';
        font-style: normal;
        font-weight: 400;
        font-display: swap;
        src: url(https://fonts.gstatic.com/s/firasans/v17/va9E4kDNxMZdWfMOD5VvmojLazX3dGTP.woff2) format('woff2');
        unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
      }

      /* cyrillic */
      @font-face {
        font-family: 'Fira Sans';
        font-style: normal;
        font-weight: 400;
        font-display: swap;
        src: url(https://fonts.gstatic.com/s/firasans/v17/va9E4kDNxMZdWfMOD5Vvk4jLazX3dGTP.woff2) format('woff2');
        unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
      }

      /* latin-ext */
      @font-face {
        font-family: 'Fira Sans';
        font-style: normal;
        font-weight: 400;
        font-display: swap;
        src: url(https://fonts.gstatic.com/s/firasans/v17/va9E4kDNxMZdWfMOD5VvmYjLazX3dGTP.woff2) format('woff2');
        unicode-range: U+0100-02AF, U+0304, U+0308, U+0329, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
      }

      /* latin */
      @font-face {
        font-family: 'Fira Sans';
        font-style: normal;
        font-weight: 400;
        font-display: swap;
        src: url(https://fonts.gstatic.com/s/firasans/v17/va9E4kDNxMZdWfMOD5Vvl4jLazX3dA.woff2) format('woff2');
        unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
      }

      /* cyrillic-ext */
      @font-face {
        font-family: 'Fira Sans';
        font-style: normal;
        font-weight: 500;
        font-display: swap;
        src: url(https://fonts.gstatic.com/s/firasans/v17/va9B4kDNxMZdWfMOD5VnZKveSxf6Xl7Gl3LX.woff2) format('woff2');
        unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
      }

      /* cyrillic */
      @font-face {
        font-family: 'Fira Sans';
        font-style: normal;
        font-weight: 500;
        font-display: swap;
        src: url(https://fonts.gstatic.com/s/firasans/v17/va9B4kDNxMZdWfMOD5VnZKveQhf6Xl7Gl3LX.woff2) format('woff2');
        unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
      }

      /* latin-ext */
      @font-face {
        font-family: 'Fira Sans';
        font-style: normal;
        font-weight: 500;
        font-display: swap;
        src: url(https://fonts.gstatic.com/s/firasans/v17/va9B4kDNxMZdWfMOD5VnZKveSBf6Xl7Gl3LX.woff2) format('woff2');
        unicode-range: U+0100-02AF, U+0304, U+0308, U+0329, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
      }

      /* latin */
      @font-face {
        font-family: 'Fira Sans';
        font-style: normal;
        font-weight: 500;
        font-display: swap;
        src: url(https://fonts.gstatic.com/s/firasans/v17/va9B4kDNxMZdWfMOD5VnZKveRhf6Xl7Glw.woff2) format('woff2');
        unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
      }

      /* cyrillic-ext */
      @font-face {
        font-family: 'Fira Sans';
        font-style: normal;
        font-weight: 700;
        font-display: swap;
        src: url(https://fonts.gstatic.com/s/firasans/v17/va9B4kDNxMZdWfMOD5VnLK3eSxf6Xl7Gl3LX.woff2) format('woff2');
        unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
      }

      /* cyrillic */
      @font-face {
        font-family: 'Fira Sans';
        font-style: normal;
        font-weight: 700;
        font-display: swap;
        src: url(https://fonts.gstatic.com/s/firasans/v17/va9B4kDNxMZdWfMOD5VnLK3eQhf6Xl7Gl3LX.woff2) format('woff2');
        unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
      }

      /* latin-ext */
      @font-face {
        font-family: 'Fira Sans';
        font-style: normal;
        font-weight: 700;
        font-display: swap;
        src: url(https://fonts.gstatic.com/s/firasans/v17/va9B4kDNxMZdWfMOD5VnLK3eSBf6Xl7Gl3LX.woff2) format('woff2');
        unicode-range: U+0100-02AF, U+0304, U+0308, U+0329, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
      }

      /* latin */
      @font-face {
        font-family: 'Fira Sans';
        font-style: normal;
        font-weight: 700;
        font-display: swap;
        src: url(https://fonts.gstatic.com/s/firasans/v17/va9B4kDNxMZdWfMOD5VnLK3eRhf6Xl7Glw.woff2) format('woff2');
        unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
      }
    </style>
    <link rel="preload" href="https://assets.habr.com/habr-web/css/theme/light-v1.css" as="style" media="(prefers-color-scheme: light)" /><link rel="preload" href="https://assets.habr.com/habr-web/css/theme/dark-v1.css" as="style" media="(prefers-color-scheme: dark)" /><link id="light-colors" rel="stylesheet" href="https://assets.habr.com/habr-web/css/theme/light-v1.css" media="(prefers-color-scheme: light)" /><link id="dark-colors" rel="stylesheet" href="https://assets.habr.com/habr-web/css/theme/dark-v1.css" media="(prefers-color-scheme: dark)" />
    <script>window.i18nFetch = new Promise((res, rej) => {
          const xhr = new XMLHttpRequest();
          xhr.open('GET', '/js/i18n/ru-compiled.35b2fec11bb79a62419ab67779c2dd82.json');
          xhr.responseType = 'json';
          xhr.onload = function(e) {
            if (this.status === 200) {
              res({ru: xhr.response});
            } else {
              rej(e);
            }
          };
          xhr.send();
        });</script>
    <style>
      .grecaptcha-badge {
        visibility: hidden;
      }
    </style>
    <meta name="habr-version" content="2.233.0">
    
    <meta name="apple-mobile-web-app-status-bar-style" content="#303b44">
    <meta name="msapplication-TileColor" content="#629FBC">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <link rel="shortcut icon" type="image/png" sizes="16x16" href="https://assets.habr.com/habr-web/img/favicons/favicon-16.png">
    <link rel="shortcut icon" type="image/png" sizes="32x32" href="https://assets.habr.com/habr-web/img/favicons/favicon-32.png">
    <link rel="apple-touch-icon" type="image/png" sizes="76x76" href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-76.png">
    <link rel="apple-touch-icon" type="image/png" sizes="120x120" href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-120.png">
    <link rel="apple-touch-icon" type="image/png" sizes="152x152" href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-152.png">
    <link rel="apple-touch-icon" type="image/png" sizes="180x180" href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-180.png">
    <link rel="apple-touch-icon" type="image/png" sizes="256x256" href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-256.png">
    <link rel="apple-touch-startup-image"
      media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
      href="https://assets.habr.com/habr-web/img/splashes/splash_1136x640.png">
    <link rel="apple-touch-startup-image"
      media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
      href="https://assets.habr.com/habr-web/img/splashes/splash_2436x1125.png">
    <link rel="apple-touch-startup-image"
      media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
      href="https://assets.habr.com/habr-web/img/splashes/splash_1792x828.png">
    <link rel="apple-touch-startup-image"
      media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
      href="https://assets.habr.com/habr-web/img/splashes/splash_828x1792.png">
    <link rel="apple-touch-startup-image"
      media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
      href="https://assets.habr.com/habr-web/img/splashes/splash_1334x750.png">
    <link rel="apple-touch-startup-image"
      media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
      href="https://assets.habr.com/habr-web/img/splashes/splash_1242x2668.png">
    <link rel="apple-touch-startup-image"
      media="screen and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
      href="https://assets.habr.com/habr-web/img/splashes/splash_2208x1242.png">
    <link rel="apple-touch-startup-image"
      media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
      href="https://assets.habr.com/habr-web/img/splashes/splash_1125x2436.png">
    <link rel="apple-touch-startup-image"
      media="screen and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
      href="https://assets.habr.com/habr-web/img/splashes/splash_1242x2208.png">
    <link rel="apple-touch-startup-image"
      media="screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
      href="https://assets.habr.com/habr-web/img/splashes/splash_2732x2048.png">
    <link rel="apple-touch-startup-image"
      media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
      href="https://assets.habr.com/habr-web/img/splashes/splash_2688x1242.png">
    <link rel="apple-touch-startup-image"
      media="screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
      href="https://assets.habr.com/habr-web/img/splashes/splash_2224x1668.png">
    <link rel="apple-touch-startup-image"
      media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
      href="https://assets.habr.com/habr-web/img/splashes/splash_750x1334.png">
    <link rel="apple-touch-startup-image"
      media="screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
      href="https://assets.habr.com/habr-web/img/splashes/splash_2048x2732.png">
    <link rel="apple-touch-startup-image"
      media="screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
      href="https://assets.habr.com/habr-web/img/splashes/splash_2388x1668.png">
    <link rel="apple-touch-startup-image"
      media="screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
      href="https://assets.habr.com/habr-web/img/splashes/splash_1668x2224.png">
    <link rel="apple-touch-startup-image"
      media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
      href="https://assets.habr.com/habr-web/img/splashes/splash_640x1136.png">
    <link rel="apple-touch-startup-image"
      media="screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
      href="https://assets.habr.com/habr-web/img/splashes/splash_1668x2388.png">
    <link rel="apple-touch-startup-image"
      media="screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
      href="https://assets.habr.com/habr-web/img/splashes/splash_2048x1536.png">
    <link rel="apple-touch-startup-image"
      media="screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
      href="https://assets.habr.com/habr-web/img/splashes/splash_1536x2048.png">
    <link rel="mask-icon" color="#77a2b6" href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-120.svg">
    <link crossorigin="use-credentials" href="/manifest.webmanifest" rel="manifest">
    <script async src="https://unpkg.com/pwacompat" crossorigin="anonymous"></script>
    <script>window.yaContextCb = window.yaContextCb || []</script>
    <script src="https://yandex.ru/ads/system/context.js" async></script>
  <link rel="preload" href="https://assets.habr.com/habr-web/css/chunk-vendors.04465f7c.css" as="style"><link rel="preload" href="https://assets.habr.com/habr-web/js/chunk-vendors.3b11d41f.js" as="script"><link rel="preload" href="https://assets.habr.com/habr-web/css/app.20959a76.css" as="style"><link rel="preload" href="https://assets.habr.com/habr-web/js/app.7a97ea6d.js" as="script"><link rel="stylesheet" href="https://assets.habr.com/habr-web/css/chunk-vendors.04465f7c.css"><link rel="stylesheet" href="https://assets.habr.com/habr-web/css/app.20959a76.css"></head>
  <body>
    
    <div id="mount"><div id="app" data-async-called="true"><div class="tm-layout__wrapper"><!--[--><!----><div></div><div class="tm-feature tm-feature"><!----></div><header class="tm-header" data-test-id="header"><div class="tm-page-width"><!--[--><div class="tm-header__container"><div class="tm-header__burger-nav" data-test-id="burger-nav"><button class="tm-header__button tm-header__button_burger" type="button"><svg class="tm-svg-img tm-header__icon tm-header__icon-burger" height="16" width="16"><title>Меню</title><use xlink:href="/img/megazord-v28.371b7fa3..svg#header-burger"></use></svg></button></div><span class="tm-header__logo-wrap"><a class="tm-header__logo tm-header__logo_hl-ru tm-header__logo" href="/ru/"><svg class="tm-svg-img tm-header__icon" height="16" width="16"><title>Хабр</title><use xlink:href="/img/habr-logo-ru.svg#logo"></use></svg></a><span style="display:none;" class="tm-header__beta-sign">β</span></span><!----><div class="tm-header-user-menu tm-header_user-menu"><a href="/ru/search/" class="tm-header-user-menu__item tm-header-user-menu__search" data-test-id="search-button"><svg class="tm-svg-img tm-header-user-menu__icon tm-header-user-menu__icon_search" height="24" width="24"><title>Поиск</title><use xlink:href="/img/megazord-v28.371b7fa3..svg#search"></use></svg></a><!----><!----><div class="tm-header-user-menu__item tm-header-user-menu__write"><div><svg class="tm-svg-img tm-header-user-menu__icon tm-header-user-menu__icon_write" height="24" width="24"><title>Написать публикацию</title><use xlink:href="/img/megazord-v28.371b7fa3..svg#write"></use></svg></div><!----></div><!--[--><div class="tm-header-user-menu__item"><button class="tm-header-user-menu__toggle" data-test-id="user-menu-settings"><svg class="tm-svg-img tm-header-user-menu__icon" height="24" width="24"><title>Настройки</title><use xlink:href="/img/megazord-v28.371b7fa3..svg#page-settings"></use></svg></button></div><a href="https://habr.com/kek/v1/auth/habrahabr/?back=/ru/companies/tbank/articles/843662/&amp;hl=ru" rel="nofollow" class="tm-header-user-menu__item"><!--[--><button class="btn btn_solid btn_small tm-header-user-menu__login" type="button"><!--[-->Войти<!--]--></button><!--]--></a><!--]--><!----><!--teleport start--><!--teleport end--><!----></div></div><!--]--></div></header><div class="tm-layout"><div class="tm-page-progress-bar"></div><!----><!----><div class="tm-page-width"><!--[--><!--]--></div><main class="tm-layout__container"><div class="tm-page" hl="ru" companyname="tbank" data-async-called="true" style="--0c809c5a:16px;--a086013e:100%;--7c457026:0;"><div class="tm-page-width"><!--[--><div class="tm-page__header"><!--[--><div class="tm-company-card__branding tm-company-card__branding_loading tm-company-article__branding" data-test-id="company-card-branding"><div class="tm-company-card__branding-placeholder"><!----></div><a href="https://meetup.tinkoff.ru/?utm_source=habr&amp;utm_medium=prt.fix&amp;utm_campaign=meetup.all.habr_header"><img class="tm-company-card__branding-image" src="//habrastorage.org/getpro/habr/branding/659/805/1f9/6598051f9c34160162a7c795e749026b.png"></a></div><!--]--></div><div class="tm-page__wrapper"><div class="tm-page__main_has-sidebar tm-page__main"><div class="pull-down"><!----><div class="pull-down__header" style="height:0px;"><div class="pull-down__content" style="bottom:10px;"><svg class="tm-svg-img pull-down__icon pull-down__arrow" height="24" width="24"><title>Обновить</title><use xlink:href="/img/megazord-v28.371b7fa3..svg#pull-arrow"></use></svg></div></div><!--[--><!--[--><div class="tm-article-presenter"><!--[--><!--]--><div class="tm-article-presenter__body" data-test-id="article-body"><div class="tm-misprint-area"><div class="tm-misprint-area__wrapper"><!--[--><article class="tm-article-presenter__content tm-article-presenter__content_narrow"><!--[--><div class="tm-article-presenter__header"><!--[--><!--]--><div class="tm-article-snippet tm-article-snippet tm-article-presenter__snippet"><!--[--><!--]--><div class="tm-article-snippet__meta-container"><div class="tm-article-snippet__meta"><span class="tm-user-info tm-article-snippet__author"><a href="/ru/users/dkotikov/" class="tm-user-info__userpic" data-test-id="user-info-pic" title="dkotikov"><div class="tm-entity-image"><!--[--><img alt="" class="tm-entity-image__pic" height="32" src="https://assets.habr.com/habr-web/img/avatars/076.png" width="32"><!--]--></div></a><span class="tm-user-info__user tm-user-info__user_appearance-default" data-test-id="user-info-description"><a href="/ru/users/dkotikov/" class="tm-user-info__username">dkotikov <!----></a><!--[--><span class="tm-article-datetime-published"><time datetime="2024-09-19T07:20:51.000Z" title="2024-09-19, 10:20">19  сен  2024 в 10:20</time></span><!--]--></span></span></div><!----></div><h1 class="tm-title tm-title_h1" lang="ru" data-test-id="articleTitle"><span>Создание плагинов и переиспользуемых частей в .gradle.kts-файлах и Kotlin extension-функциях</span></h1><div class="tm-article-snippet__stats" data-test-id="articleStats"><div class="tm-article-complexity tm-article-complexity_complexity-medium"><span class="tm-svg-icon__wrapper tm-article-complexity__icon"><svg class="tm-svg-img tm-svg-icon" height="24" width="24"><title>Уровень сложности</title><use xlink:href="/img/megazord-v28.371b7fa3..svg#complexity-medium"></use></svg></span><span class="tm-article-complexity__label">Средний</span></div><div class="tm-article-reading-time"><span class="tm-svg-icon__wrapper tm-article-reading-time__icon"><svg class="tm-svg-img tm-svg-icon" height="24" width="24"><title>Время на прочтение</title><use xlink:href="/img/megazord-v28.371b7fa3..svg#clock"></use></svg></span><span class="tm-article-reading-time__label">11 мин</span></div><span class="tm-icon-counter tm-data-icons__item"><svg class="tm-svg-img tm-icon-counter__icon" height="24" width="24"><title>Количество просмотров</title><use xlink:href="/img/megazord-v28.371b7fa3..svg#counter-views"></use></svg><span class="tm-icon-counter__value" title="3724">3.7K</span></span></div><div class="tm-publication-hubs__container" data-test-id="articleHubsList"><div class="tm-publication-hubs"><!--[--><span class="tm-publication-hub__link-container"><a href="/ru/companies/tbank/articles/" class="tm-publication-hub__link"><!--[--><span>Блог компании Т-Банк</span><!----><!--]--></a></span><span class="tm-publication-hub__link-container"><a href="/ru/hubs/android_dev/" class="tm-publication-hub__link"><!--[--><span>Разработка под Android</span><span class="tm-article-snippet__profiled-hub" title="Профильный хаб">*</span><!--]--></a></span><span class="tm-publication-hub__link-container"><a href="/ru/hubs/kotlin/" class="tm-publication-hub__link"><!--[--><span>Kotlin</span><span class="tm-article-snippet__profiled-hub" title="Профильный хаб">*</span><!--]--></a></span><span class="tm-publication-hub__link-container"><a href="/ru/hubs/gradle/" class="tm-publication-hub__link"><!--[--><span>Gradle</span><span class="tm-article-snippet__profiled-hub" title="Профильный хаб">*</span><!--]--></a></span><!--]--></div></div><div class="tm-article-labels" data-test-id="articleLabels"><div class="tm-article-labels__container"><div class="tm-publication-label tm-publication-label_variant-tutorial"><span>Туториал</span></div><!--[--><!--]--></div></div><!----><!----></div></div><!--[--><!----><div class="tm-article-body" data-gallery-root lang="ru"><div><!--[--><!--]--></div><div id="post-content-body"><div><div class="article-formatted-body article-formatted-body article-formatted-body_version-2"><div xmlns="http://www.w3.org/1999/xhtml"><figure class="full-width "><img src="https://habrastorage.org/r/w780q1/getpro/habr/upload_files/d29/4ab/179/d294ab179d9d24fe32e62ca32ea1d55f.jpg" width="1560" height="880" data-src="https://habrastorage.org/getpro/habr/upload_files/d29/4ab/179/d294ab179d9d24fe32e62ca32ea1d55f.jpg" data-blurred="true"/></figure><p>Всем привет! На связи Дима Котиков, и мы продолжаем разговор о том, как облегчить себе жизнь и уменьшить Boilerplate в gradle-файлах. <a href="https://habr.com/ru/companies/tbank/articles/843648/">В первой части</a> поговорили о том, как подготовиться к созданию модулей для Gradle Convention Plugin. Двигаемся дальше!</p><h2>Создание базовых Convention Plugins и extension-функций</h2><p>Начнем с создания базовой конфигурации для android-таргета, но перед этим добавим <code>minSdk</code>, <code>targetSdk</code> и <code>compileSdk</code> в <code>libs.versions.toml</code> для того, чтобы была возможность изменять эти значения в одном месте сразу для всех модулей.</p><figure class="full-width "><img src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/7ac/297/fd1/7ac297fd1b3a47247b11ba16145a2b14.png" alt="Добавление minSdk, targetSdk и compileSdk в libs.versions.toml" title="Добавление minSdk, targetSdk и compileSdk в libs.versions.toml" width="1600" height="952" data-src="https://habrastorage.org/getpro/habr/upload_files/7ac/297/fd1/7ac297fd1b3a47247b11ba16145a2b14.png"/><div><figcaption>Добавление <code>minSdk</code>, <code>targetSdk</code> и <code>compileSdk</code> в <code>libs.versions.toml</code></figcaption></div></figure><p>Сравним конфигурации для <code>composeApp</code> и <code>shared-uikit</code> модулей:</p><figure class="full-width "><img src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/f07/5f6/218/f075f6218a724ecc783568074bf2ec04.png" alt="Сравнение android-конфигураций для app- и library-модулей" title="Сравнение android-конфигураций для app- и library-модулей" width="1600" height="911" data-src="https://habrastorage.org/getpro/habr/upload_files/f07/5f6/218/f075f6218a724ecc783568074bf2ec04.png"/><div><figcaption>Сравнение android-конфигураций для app- и library-модулей</figcaption></div></figure><p>Какие общие части можно выделить:</p><figure class="full-width "><img src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/128/329/864/1283298641429445bee06321cd640616.png" alt="Общие части android-конфигураций" title="Общие части android-конфигураций" width="1600" height="1005" data-src="https://habrastorage.org/getpro/habr/upload_files/128/329/864/1283298641429445bee06321cd640616.png"/><div><figcaption>Общие части android-конфигураций</figcaption></div></figure><p>Видим, что выделенные стрелками и блоками части абсолютно идентичны и мы можем вынести их в общую конфигурацию. Для этого нам сначала нужно взглянуть на функцию <code>android</code> и посмотреть контекст, на котором выполняется логика. Проваливаемся в функции <code>android</code> наших модулей и видим проблемку: для app- и library-модуля <abbr class="habraabbr" title="А также функция android не доступна в gradle-файлах без подключения плагина com.android.application или com.android.library" data-title="&lt;p&gt;А также функция &lt;code&gt;android&lt;/code&gt; не доступна в gradle-файлах без подключения плагина &lt;code&gt;com.android.application&lt;/code&gt; или &lt;code&gt;com.android.library&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;" data-abbr="функция android конфигурирует немного разные сущности">функция android конфигурирует немного разные сущности</abbr>.</p><figure class="full-width "><img src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/67e/6b6/5af/67e6b65afa6ff4c88ce317f7294e02b3.png" alt="Разные типы Actions в Extension Android для app- и library-модулей" title="Разные типы Actions в Extension Android для app- и library-модулей" width="1600" height="433" data-src="https://habrastorage.org/getpro/habr/upload_files/67e/6b6/5af/67e6b65afa6ff4c88ce317f7294e02b3.png"/><div><figcaption>Разные типы Actions в Extension Android для app- и library-модулей</figcaption></div></figure><h2>Что же теперь делать</h2><figure class="full-width "><img src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/72d/8a7/ab8/72d8a7ab8a7f76683b75c3a940d3fbad.png" width="1001" height="793" data-src="https://habrastorage.org/getpro/habr/upload_files/72d/8a7/ab8/72d8a7ab8a7f76683b75c3a940d3fbad.png"/></figure><p>Нужно копнуть глубже и найти, что <code>BaseAppModuleExtension</code> и <code>LibraryExtension</code> наследуются от одного интерфейса <code>CommonExtension&lt;BuildFeaturesT : BuildFeatures, BuildTypeT : BuildType, DefaultConfigT : DefaultConfig, ProductFlavorT : ProductFlavor, AndroidResourcesT : AndroidResources&gt;</code>. Его и будем использовать для обобщения android-конфигурации. </p><p>Но перед написанием Convention Plugin сделаем пару удобных Extensions. Создаем файл <code>BaseExtensions.kt</code> и добавляем следующее:</p><pre><code class="kotlin">package io.github.dmitriy1892.conventionplugins.base.extensions
 
import com.android.build.api.dsl.AndroidResources
import com.android.build.api.dsl.BuildFeatures
import com.android.build.api.dsl.BuildType
import com.android.build.api.dsl.CommonExtension
import com.android.build.api.dsl.DefaultConfig
import com.android.build.api.dsl.LibraryExtension
import com.android.build.api.dsl.ProductFlavor
import com.android.build.gradle.internal.dsl.BaseAppModuleExtension
import org.gradle.api.Project
import org.gradle.kotlin.dsl.findByType
import org.gradle.kotlin.dsl.withType
import org.jetbrains.kotlin.gradle.dsl.KotlinJvmCompilerOptions
import org.jetbrains.kotlin.gradle.tasks.KotlinJvmCompile
 
private typealias AndroidExtensions = CommonExtension&lt;
        out BuildFeatures,
        out BuildType,
        out DefaultConfig,
        out ProductFlavor,
        out AndroidResources&gt;
 
private val Project.androidExtension: AndroidExtensions
    get() = extensions.findByType(BaseAppModuleExtension::class)
        ?: extensions.findByType(LibraryExtension::class)
        ?: error(
            "\"Project.androidExtension\" value may be called only from android application" +
                    " or android library gradle script"
        )
 
fun Project.androidConfig(block: AndroidExtensions.() -&gt; Unit): Unit = block(androidExtension)
 
fun Project.kotlinJvmCompilerOptions(block: KotlinJvmCompilerOptions.() -&gt; Unit) {
    tasks.withType&lt;KotlinJvmCompile&gt;().configureEach {
	    compilerOptions(block)
    }
}</code></pre><p>Мы объявили typealias <code>AndroidExtensions</code> для интерфейса <code>CommonExtension</code>, чтобы не писать все Generic из раза в раз.</p><p>В extension-поле <code>Project.androidExtension</code> обращаемся к <code>extensions</code> нашего gradle-проекта и пытаемся найти <code>BaseAppModuleExtension</code> или <code>LibraryExtension</code>, которые являются наследниками интерфейса <code>CommonExtension</code>.</p><p>В функции <code>Project.androidConfig</code> предоставляем лямбду <code>block</code> с контекстом на <code>AndroidExtensions</code>. Теперь при использовании этой функции мы сможем задавать android-specific-конфигурации.</p><p>В функции <code>Project.kotlinJvmCompilerOptions</code> мы ищем таску <code>KotlinJvmCompile</code> для того, чтобы предоставить возможность сконфигурировать в лямбде <code>block</code> параметры kotlin-компилятора под JVM-таргет.</p><p>Далее создаем файл <code>android.base.config.gradle.kts</code>, пытаемся сконфигурировать и натыкаемся на то, что version catalog недоступен в нашем Convention Plugin.</p><figure class="full-width "><img src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/7eb/187/480/7eb187480038e6156bc791ff01a0404e.png" alt="Version Catalog недоступен" title="Version Catalog недоступен" width="1600" height="675" data-src="https://habrastorage.org/getpro/habr/upload_files/7eb/187/480/7eb187480038e6156bc791ff01a0404e.png"/><div><figcaption>Version Catalog недоступен</figcaption></div></figure><p>В предыдущем разделе в файле <code>build.gradle.kts</code> мы указывали workaround для того, чтобы работали Version Catalogs —  но этого нам недостаточно. Чтобы Version Catalogs у нас заработали, напишем еще один extension. Идем в файл <code>BaseExtensions.kt</code> и добавляем такой код:</p><pre><code class="kotlin">package io.github.dmitriy1892.conventionplugins.base.extensions
 
 import org.gradle.accessors.dm.LibrariesForLibs
 import org.gradle.api.Project
 import org.gradle.kotlin.dsl.the
 
... 
 val Project.libs: LibrariesForLibs
     get() = the&lt;LibrariesForLibs&gt;()</code></pre><p>Для удобства в этом же файле добавим extension на получение версии Java, он понадобится в нескольких местах. Итого получаем:</p><pre><code class="kotlin"> package io.github.dmitriy1892.conventionplugins.base.extensions
  
 import org.gradle.accessors.dm.LibrariesForLibs
 import org.gradle.api.JavaVersion
 import org.gradle.api.Project
 import org.gradle.kotlin.dsl.the
  
 val Project.libs: LibrariesForLibs
     get() = the&lt;LibrariesForLibs&gt;()
  
 val Project.projectJavaVersion: JavaVersion
     get() = JavaVersion.toVersion(libs.versions.java.get().toInt())
</code></pre><p>Возвращаемся к <code>android.base.config.gradle.kts</code> и конфигурируем, не забывая про импорты наших extension-функций:</p><pre><code class="kotlin">import io.github.dmitriy1892.conventionplugins.base.extensions.androidConfig
import io.github.dmitriy1892.conventionplugins.base.extensions.kotlinJvmCompilerOptions
import io.github.dmitriy1892.conventionplugins.base.extensions.libs
import io.github.dmitriy1892.conventionplugins.base.extensions.projectJavaVersion
import org.jetbrains.kotlin.gradle.dsl.JvmTarget
 
androidConfig {
    compileSdk = libs.versions.compileSdk.get().toInt()
 
    defaultConfig {
        minSdk = libs.versions.minSdk.get().toInt()
    }
 
    sourceSets["main"].apply {
        manifest.srcFile("src/androidMain/AndroidManifest.xml")
        res.srcDirs("src/androidMain/res")
    }
 
    compileOptions {
        sourceCompatibility = JavaVersion.VERSION_1_8
        targetCompatibility = JavaVersion.VERSION_1_8
    }
}
 
kotlinJvmCompilerOptions {
    jvmTarget.set(JvmTarget.fromTarget(projectJavaVersion.toString()))
    freeCompilerArgs.add("-Xjdk-release=${projectJavaVersion}")
}
</code></pre><p>Откуда взялся блок <code>kotlinJvmCompilerOptions</code> и зачем он нам? Если мы посмотрим еще раз на файлы <code>build.gradle.kts</code>  в модулях <code>composeApp</code> и <code>shared-uikit</code>, в блоке <code>kotlin</code> увидим следующее:</p><figure class="full-width "><img src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/cc8/0a7/c67/cc80a7c67ea0d645da20e2aa55ba6e18.png" alt="Общие части в build.gradle.kts-файлах модулей composeApp и shared-uikit" title="Общие части в build.gradle.kts-файлах модулей composeApp и shared-uikit" width="1600" height="602" data-src="https://habrastorage.org/getpro/habr/upload_files/cc8/0a7/c67/cc80a7c67ea0d645da20e2aa55ba6e18.png"/><div><figcaption>Общие части в <code>build.gradle.kts</code>-файлах модулей <code>composeApp</code> и <code>shared-uikit</code></figcaption></div></figure><p>Как видим на картинке, в выделенных красным блоках конфигурируются настройки компилятора для android-таргета. По этой причине мы и вынесли их в файл  <code>android.base.config.gradle.kts</code>, предварительно настроив extension-функцию в <code>BaseExtensions.kt</code> .</p><p>Применяем в <code>build.gradle.kts</code>-файлах модулей наш Convention Plugin и удаляем блоки кода, которые уже есть в <code>android.base.config.gradle.kts</code>. Скриншоты приложил только для модуля <code>shared-uikit</code>, но такие же правки проведены и в <code>composeApp</code>.</p><figure class="full-width "><img src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/215/080/76b/21508076bf5dab60685506dcf5745281.png" alt="Добавление Convention Plugin в shared-uikit/build.gradle.kts и удаление кода настроек компилятора" title="Добавление Convention Plugin в shared-uikit/build.gradle.kts и удаление кода настроек компилятора" width="1600" height="577" data-src="https://habrastorage.org/getpro/habr/upload_files/215/080/76b/21508076bf5dab60685506dcf5745281.png"/><div><figcaption>Добавление Convention Plugin в <code>shared-uikit/build.gradle.kts</code> и удаление кода настроек компилятора</figcaption></div></figure><figure class="full-width "><img src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/957/9f2/1cf/9579f21cfaa6d2d8ecd5b7b5f3bb08da.png" alt="Удаление кода из shared-uikit/build.gradle.kts. Добавили его выше в android.base.config.gradle.kts" title="Удаление кода из shared-uikit/build.gradle.kts. Добавили его выше в android.base.config.gradle.kts" width="1600" height="542" data-src="https://habrastorage.org/getpro/habr/upload_files/957/9f2/1cf/9579f21cfaa6d2d8ecd5b7b5f3bb08da.png"/><div><figcaption>Удаление кода из <code>shared-uikit/build.gradle.kts</code>. Добавили его выше в <code>android.base.config.gradle.kts</code></figcaption></div></figure><p>Пытаемся синхронизироваться, и-и-и... Видим ошибку:</p><figure class="full-width "><img src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/765/38b/ef0/76538bef03ce53d2dd86ffca7587506f.png" alt="Ошибка синхронизации проекта после добавления Convention Plugin" title="Ошибка синхронизации проекта после добавления Convention Plugin" width="1600" height="484" data-src="https://habrastorage.org/getpro/habr/upload_files/765/38b/ef0/76538bef03ce53d2dd86ffca7587506f.png"/><div><figcaption>Ошибка синхронизации проекта после добавления Convention Plugin</figcaption></div></figure><p>Ошибка появляется потому, что в плагине <code>android.base.config.gradle.kts</code> мы добавили блок конфигурации базового android-проекта, но не добавляли плагин <code>com.android.application</code> или <code>com.android.library</code>. Gradle применяет наши плагины поочередно сверху вниз? и так как до Convention Plugin никакие другие плагины не применены, появилась ошибка.</p><p>Достаточно указать Convention Plugin ниже android-плагина, чтобы исправить этот позорный недуг.</p><figure class="full-width "><img src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/32a/8a7/c7a/32a8a7c7a958041bbf56798f91a44462.png" alt="Исправление ошибки сборки" title="Исправление ошибки сборки" width="1292" height="520" data-src="https://habrastorage.org/getpro/habr/upload_files/32a/8a7/c7a/32a8a7c7a958041bbf56798f91a44462.png"/><div><figcaption>Исправление ошибки сборки</figcaption></div></figure><p>Синхронизируемся, собираем проект — все заработало!</p><figure class="full-width "><img src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/b63/5da/329/b635da32904c134daa0d4a7f13b566dc.png" alt="Успешная сборка" title="Успешная сборка" width="1600" height="353" data-src="https://habrastorage.org/getpro/habr/upload_files/b63/5da/329/b635da32904c134daa0d4a7f13b566dc.png"/><div><figcaption>Успешная сборка</figcaption></div></figure><p>Дальше — больше, продолжаем выносить общую логику. Сконфигурируем тесты для android-таргета, в папке с плагинами создаем файл <code>android.base.test.config.gradle.kts</code>, но перед его наполнением добавим еще Extensions для удобства.</p><p>Для создания extension-функции для блока <code>androidTarget</code> нам нужно посмотреть, как до нее можно добраться.</p><figure class="full-width "><img src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/997/bee/db6/997beedb64e9c90ab23a028971be7c5f.png" alt="Блок androidTarget внутри блока kotlin" title="Блок androidTarget внутри блока kotlin" width="1600" height="1040" data-src="https://habrastorage.org/getpro/habr/upload_files/997/bee/db6/997beedb64e9c90ab23a028971be7c5f.png"/><div><figcaption>Блок <code>androidTarget</code> внутри блока kotlin</figcaption></div></figure><p>Проваливаемся в функцию <code>androidTarget</code>:</p><figure class="full-width "><img src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/e5b/9e9/e04/e5b9e9e04fb4a57d33849ac092e6de9e.png" alt="Функция androidTarget" title="Функция androidTarget" width="1600" height="472" data-src="https://habrastorage.org/getpro/habr/upload_files/e5b/9e9/e04/e5b9e9e04fb4a57d33849ac092e6de9e.png"/><div><figcaption>Функция androidTarget</figcaption></div></figure><p>Видим, что функция <code>androidTarget</code> — часть интерфейса <code>KotlinTargetContainerWithPresetFunctions</code> и что интерфейс реализуется классом <code>KotlinMultiplatformExtension</code>.</p><figure class="full-width "><img src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/426/8a3/c9e/4268a3c9e5ecb0a3ca7ce3d184f10f74.png" alt="KotlinTargetContainerWithPresetFunctions реализуется классом KotlinMultiplatformExtension" title="KotlinTargetContainerWithPresetFunctions реализуется классом KotlinMultiplatformExtension" width="1600" height="427" data-src="https://habrastorage.org/getpro/habr/upload_files/426/8a3/c9e/4268a3c9e5ecb0a3ca7ce3d184f10f74.png"/><div><figcaption><code>KotlinTargetContainerWithPresetFunctions</code> реализуется классом <code>KotlinMultiplatformExtension</code></figcaption></div></figure><p><code>KotlinMultiplatformExtension</code> мы можем добыть уже знакомым нам способом через поиск в <code>Project.extensions</code>. Возвращаемся в файл <code>BaseExtensions.kt</code> и пишем:</p><pre><code class="kotlin">fun Project.kotlinAndroidTarget(block: KotlinAndroidTarget.() -&gt; Unit) {
    extensions.findByType(KotlinMultiplatformExtension::class)
	    ?.androidTarget(block)
	    ?: error("Kotlin multiplatform was not been added")
}</code></pre><p>Далее идем в файл <code>android.base.test.config.gradle.kts</code> и конфигурируем тесты с помощью написанного нами Extension <code>Project.kotlinAndroidTarget</code>. В процессе видим, что при настройке <code>instrumentedTestVariant</code> в блоке <code>dependencies</code> недоступны функции <code>implementation</code>/<code>debugImplementation</code>.</p><figure class="full-width "><img src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/4d0/3a0/e1f/4d03a0e1fded8cdf2c18fc891eefb35c.png" alt="Нет доступа к implementation/debugImplementation" title="Нет доступа к implementation/debugImplementation" width="1377" height="630" data-src="https://habrastorage.org/getpro/habr/upload_files/4d0/3a0/e1f/4d03a0e1fded8cdf2c18fc891eefb35c.png"/><div><figcaption>Нет доступа к <code>implementation</code>/<code>debugImplementation</code></figcaption></div></figure><p>В этом случае мы пишем очередные Extensions! Для этого создадим отдельный файл <code>DependenciesExtensions.kt</code>, т. к. он пригодится нам дальше, и пишем следующие функции:</p><pre><code class="kotlin">package io.github.dmitriy1892.conventionplugins.base.extensions
 
import org.gradle.api.artifacts.MinimalExternalModuleDependency
import org.gradle.api.provider.Provider import org.gradle.kotlin.dsl.DependencyHandlerScope
 
fun DependencyHandlerScope.implementation( dependency: Provider ) {
    add("implementation", dependency)
}
 
fun DependencyHandlerScope.debugImplementation( dependency: Provider ) {
    add("debugImplementation", dependency)
}</code></pre><p>Применяем это в файле <code>android.base.test.config.gradle.kts</code>, также заполняем другие данные для плагина теста. Получаем такой вид:</p><pre><code class="kotlin">import com.android.build.api.dsl.ManagedVirtualDevice
import io.github.dmitriy1892.conventionplugins.base.extensions.androidConfig
import io.github.dmitriy1892.conventionplugins.base.extensions.debugImplementation
import io.github.dmitriy1892.conventionplugins.base.extensions.implementation
import io.github.dmitriy1892.conventionplugins.base.extensions.kotlinAndroidTarget
import io.github.dmitriy1892.conventionplugins.base.extensions.libs
import org.jetbrains.kotlin.gradle.plugin.KotlinSourceSetTree
 
kotlinAndroidTarget {
    instrumentedTestVariant {
	    sourceSetTree.set(KotlinSourceSetTree.test)
 
	    dependencies {
	        debugImplementation(libs.androidx.testManifest)
	        implementation(libs.androidx.junit4)
	    }
    }
}
 
androidConfig {
    defaultConfig {
	    testInstrumentationRunner = "androidx.test.runner.AndroidJUnitRunner"
    }
 
    //https://developer.android.com/studio/test/gradle-managed-devices
    @Suppress("UnstableApiUsage")
    testOptions {
	    managedDevices.devices {
	        maybeCreate&lt;ManagedVirtualDevice&gt;("pixel5").apply {
	            device = "Pixel 5"
	            apiLevel = libs.versions.targetSdk.get().toInt()
	            systemImageSource = "aosp"
	        }
	    }
    }
}</code></pre><p>Применяем наш новосозданный плагин в <code>build.gradle.kts</code>-файлах модулей проекта и удаляем обобщенные в плагине блоки.</p><figure class="full-width "><img src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/4ab/cb9/6e5/4abcb96e5f523711de6eb4f5088627ed.png" alt="Добавление плагина тестов и удаление обобщенных скриптов" title="Добавление плагина тестов и удаление обобщенных скриптов" width="1600" height="885" data-src="https://habrastorage.org/getpro/habr/upload_files/4ab/cb9/6e5/4abcb96e5f523711de6eb4f5088627ed.png"/><div><figcaption>Добавление плагина тестов и удаление обобщенных скриптов</figcaption></div></figure><figure class="full-width "><img src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/b7a/5e1/a17/b7a5e1a17b1c4f710ef2cafab9c8fb56.png" alt="Удаление обобщенных тестовых скриптов из android-блока" title="Удаление обобщенных тестовых скриптов из android-блока" width="1600" height="969" data-src="https://habrastorage.org/getpro/habr/upload_files/b7a/5e1/a17/b7a5e1a17b1c4f710ef2cafab9c8fb56.png"/><div><figcaption>Удаление обобщенных тестовых скриптов из android-блока</figcaption></div></figure><p>Синхронизируемся, проверяем, что наш мультиплатформенный тест работает с помощью команды <code>./gradlew :composeApp:connectedAndroidTest</code>, и видим, что все успешно. Почему не напрямую делаем Run Test из UI для android-таргета — потому что <a href="https://www.jetbrains.com/help/kotlin-multiplatform-dev/compose-test.html#28a09030:~:text=)%0A%20%20%20%20%7D%0A%7D-,To%20run%20tests%3A,-iOS%20Simulator"><u>это не работает в KMP.</u></a></p><p>Вынесем в Convention Plugin логику конфигурации мультиплатформенного проекта — подключение плагина и добавление таргетов, под которые собирается проект. Создаем файл <code>kmp.base.config.gradle.kts</code> и наполняем:</p><pre><code class="kotlin">plugins {
    id("org.jetbrains.kotlin.multiplatform")
}
 
kotlin {
    androidTarget()
 
    jvm()
 
    iosX64()
    iosArm64()
    iosSimulatorArm64()
}</code></pre><p>Вынесем логику для упаковки iOS Framework в отдельный Extension. Для этого выделим получение <code>KotlinMultiplatformExtension</code> в отдельный Extension и заодно отрефакторим функцию <code>kotlinAndroidTarget</code>:</p><pre><code class="kotlin">fun Project.kotlinMultiplatformConfig(block: KotlinMultiplatformExtension.() -&gt; Unit) {
    extensions.findByType&lt;KotlinMultiplatformExtension&gt;()
	    ?.apply(block)
	    ?: error("Kotlin multiplatform was not been added")
}
 
fun Project.kotlinAndroidTarget(block: KotlinAndroidTarget.() -&gt; Unit) {
    kotlinMultiplatformConfig {
	    androidTarget(block)
    }
}</code></pre><p>Далее создадим файл <code>IosExtensions.kt</code> и пропишем:</p><pre><code class="kotlin">package io.github.dmitriy1892.conventionplugins.base.extensions
 
import org.gradle.api.Project
import org.jetbrains.kotlin.gradle.plugin.mpp.Framework
import org.jetbrains.kotlin.gradle.plugin.mpp.KotlinNativeTarget
 
fun Project.iosRegularFramework(
    block: Framework.() -&gt; Unit
) {
    kotlinMultiplatformConfig {
	    targets
	        .filterIsInstance&lt;KotlinNativeTarget&gt;()
	        .forEach { nativeTarget -&gt; nativeTarget.binaries.framework(configure = block) }
    }
}</code></pre><p>Теперь можем применить плагин и Extension в наших <code>build.gradle.kts</code>-файлах:</p><figure class="full-width "><img src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/df5/c33/b15/df5c33b15adde3034f2e61ae6d7ad274.png" alt="Применение плагина kmp.base.config" title="Применение плагина kmp.base.config" width="1600" height="829" data-src="https://habrastorage.org/getpro/habr/upload_files/df5/c33/b15/df5c33b15adde3034f2e61ae6d7ad274.png"/><div><figcaption>Применение плагина <code>kmp.base.config</code></figcaption></div></figure><figure class="full-width "><img src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/e24/1ce/f83/e241cef83b68ef0cf70545fce2eee3f7.png" alt="Добавление Extension iosRegularFramework" title="Добавление Extension iosRegularFramework" width="1600" height="345" data-src="https://habrastorage.org/getpro/habr/upload_files/e24/1ce/f83/e241cef83b68ef0cf70545fce2eee3f7.png"/><div><figcaption>Добавление Extension <code>iosRegularFramework</code></figcaption></div></figure><h2>Что мы можем еще улучшить</h2><p>Взглянем на блок с зависимостями, объявляемыми для всех таргетов:</p><figure class="full-width "><img src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/10f/e48/7e4/10fe487e4328b667e4c97f1b3c08f2f2.png" alt="Стандартное объявление зависимостей в KMP" title="Стандартное объявление зависимостей в KMP" width="1183" height="1600" data-src="https://habrastorage.org/getpro/habr/upload_files/10f/e48/7e4/10fe487e4328b667e4c97f1b3c08f2f2.png"/><div><figcaption>Стандартное объявление зависимостей в KMP</figcaption></div></figure><p>Видим Callback Hell из функций <code>kotlin { sourceSets { &lt;target&gt;.dependencies { implementation(...) } } }</code> — выглядит не очень. Можем попробовать улучшить положение через объявление в блоке <code>dependencies</code> на уровне файла.</p><figure class="full-width "><img src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/dfd/7ac/e76/dfd7ace76293eda1a2c90156d0341b20.png" alt="Попытка объявления зависимостей в верхнеуровневом блоке dependencies" title="Попытка объявления зависимостей в верхнеуровневом блоке dependencies" width="1455" height="1371" data-src="https://habrastorage.org/getpro/habr/upload_files/dfd/7ac/e76/dfd7ace76293eda1a2c90156d0341b20.png"/><div><figcaption>Попытка объявления зависимостей в верхнеуровневом блоке <code>dependencies</code></figcaption></div></figure><p>Далеко не все таргеты доступны в этом блоке, да и каша из объявлений зависимостей между таргетами при таком подходе неизбежна на дистанции. </p><p>Как улучшить положение? Конечно же, написать очередную пачку удобных Extensions.  Создадим новый файл <code>KmpDependenciesExtensions.kt</code> и пропишем:</p><pre><code class="kotlin">package io.github.dmitriy1892.conventionplugins.base.extensions
 
import org.gradle.api.Project
import org.jetbrains.kotlin.gradle.plugin.KotlinDependencyHandler
 
fun Project.commonMainDependencies(block: KotlinDependencyHandler.() -&gt; Unit) {
    kotlinMultiplatformConfig {
	    sourceSets.commonMain.dependencies(block)
    }
}
 
fun Project.commonTestDependencies(block: KotlinDependencyHandler.() -&gt; Unit) {
    kotlinMultiplatformConfig {
	    sourceSets.commonTest.dependencies(block)
    }
}
 
fun Project.androidMainDependencies(block: KotlinDependencyHandler.() -&gt; Unit) {
    kotlinMultiplatformConfig {
	    sourceSets.androidMain.dependencies(block)
    }
}
 
fun Project.jvmMainDependencies(block: KotlinDependencyHandler.() -&gt; Unit) {
    kotlinMultiplatformConfig {
	    sourceSets.jvmMain.dependencies(block)
    }
}
 
fun Project.iosMainDependencies(block: KotlinDependencyHandler.() -&gt; Unit) {
    kotlinMultiplatformConfig {
	    sourceSets.iosMain.dependencies(block)
    }
}</code></pre><p>Применяем Extensions в <code>build.gradle.kts</code>-файлах:</p><figure class="full-width "><img src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/d4b/b87/188/d4bb87188dc8dfdc68fa5545fa72adfc.png" alt="Применение extension-функций для объявления зависимостей на уровне файла" title="Применение extension-функций для объявления зависимостей на уровне файла" width="1600" height="965" data-src="https://habrastorage.org/getpro/habr/upload_files/d4b/b87/188/d4bb87188dc8dfdc68fa5545fa72adfc.png"/><div><figcaption>Применение extension-функций для объявления зависимостей на уровне файла</figcaption></div></figure><p>Видим, что зависимости compose покраснели — произошло это потому, что зависимости на compose-библиотеки лежат <abbr class="habraabbr" title="org.jetbrains.compose.ComposePlugin" data-title="&lt;p&gt;org.jetbrains.compose.ComposePlugin&lt;/p&gt;&lt;p&gt;&lt;/p&gt;" data-abbr="в недрах Compose Multiplatform Plugin">в недрах Compose Multiplatform Plugin</abbr>, а не в Version Catalog, и при вынесении зависимостей в наши extension-функции перестал быть виден контекст <code>org.jetbrains.compose.ComposePlugin</code>. Но это не страшно, т. к. мы будем выносить конфигурацию compose в отдельный плагин, чем и займемся.</p><p>Сконфигурируем android-таргет. Для этого создадим файл <code>android.compose.config.gradle.kts</code> и наполним:</p><pre><code class="kotlin">import io.github.dmitriy1892.conventionplugins.base.extensions.androidConfig
 
plugins {
    id("android.base.config")
}
 
 
androidConfig {
    buildFeatures {
	    //enables a Compose tooling support in the AndroidStudio
	    compose = true
    }
}</code></pre><p>Также создаем файл <code>kmp.compose.config.gradle.kts</code> и наполняем:</p><pre><code class="kotlin">import io.github.dmitriy1892.conventionplugins.base.extensions.libs
 
plugins {
    id("org.jetbrains.kotlin.plugin.compose")
    id("org.jetbrains.compose")
 
    id("kmp.base.config")
    id("android.compose.config")
}
 
kotlin {
    sourceSets {
	    commonMain.dependencies {
	        implementation(compose.runtime)
	        implementation(compose.foundation)
	        implementation(compose.material3)
	        implementation(compose.components.resources)
	        implementation(compose.components.uiToolingPreview)
	    }
 
	    commonTest.dependencies {
	        implementation(kotlin("test"))
	        @OptIn(org.jetbrains.compose.ExperimentalComposeLibrary::class)
	        implementation(compose.uiTest)
	    }
 
	    androidMain.dependencies {
	        implementation(compose.uiTooling)
	        implementation(libs.androidx.activityCompose)
	    }
 
	    jvmMain.dependencies {
	        implementation(compose.desktop.currentOs)
	    }
    }
}</code></pre><p>В плагине <code>android.compose.config.gradle.kts</code> мы применили <code>android.base.config</code>, а в плагине <code>kmp.compose.config.gradle.kts</code> — и <code>android.compose.config.gradle.kts</code>, и <code>kmp.base.config</code>. Соответственно, их можно убрать из <code>build.gradle.kts</code>-файлов, если подключить туда один наш плагин <code>kmp.compose.config.gradle.kts</code>, что и сделаем.</p><figure class="full-width "><img src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/987/904/fab/987904fab133374e7431ec1b0afcb1cd.png" alt="Применение kmp.compose.config-плагина" title="Применение kmp.compose.config-плагина" width="1600" height="955" data-src="https://habrastorage.org/getpro/habr/upload_files/987/904/fab/987904fab133374e7431ec1b0afcb1cd.png"/><div><figcaption>Применение <code>kmp.compose.config</code>-плагина</figcaption></div></figure><figure class="full-width "><img src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/0f0/e8f/849/0f0e8f8499fbb080fe359f6a287560c6.png" alt="Применение kmp.compose.config-плагина" title="Применение kmp.compose.config-плагина" width="1600" height="975" data-src="https://habrastorage.org/getpro/habr/upload_files/0f0/e8f/849/0f0e8f8499fbb080fe359f6a287560c6.png"/><div><figcaption>Применение <code>kmp.compose.config</code>-плагина</figcaption></div></figure><p>Синхронизируем проект, проверяем, что все собралось.</p><hr/><p>Подведем промежуточные итоги. Исходный <code>build.gradle.kts</code>-файл в модуле <code>composeApp</code> занимал 143 строчки кода. Теперь же он уменьшился до 74 строк кода —  практически в 2 раза. Вполне себе неплохо. Но это еще не предел. Идем к светлому будущему — следующему разделу: <a href="https://habr.com/ru/companies/tbank/articles/843786/">созданию Convention Plugins в kotlin-файлах и их регистрации для дальнейшего переиспользования</a>.</p><p></p></div></div></div><!----><!----></div><!----><!----></div><!--]--><!----><div class="tm-article-presenter__meta" data-test-id="article-meta-links"><div class="tm-separated-list tm-article-presenter__meta-list"><span class="tm-separated-list__title">Теги:</span><ul class="tm-separated-list__list"><!--[--><li class="tm-separated-list__item"><!--[--><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=[Gradle+Convention+Plugins]" class="tm-tags-list__link"><span>Gradle Convention Plugins</span></a><!--]--></li><li class="tm-separated-list__item"><!--[--><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=[Gradle]" class="tm-tags-list__link"><span>Gradle</span></a><!--]--></li><li class="tm-separated-list__item"><!--[--><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=[Kotlin]" class="tm-tags-list__link"><span>Kotlin</span></a><!--]--></li><li class="tm-separated-list__item"><!--[--><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=[Android]" class="tm-tags-list__link"><span>Android</span></a><!--]--></li><li class="tm-separated-list__item"><!--[--><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=[Kotlin+Multiplatform]" class="tm-tags-list__link"><span>Kotlin Multiplatform</span></a><!--]--></li><!--]--><!----></ul></div><div class="tm-separated-list tm-article-presenter__meta-list"><span class="tm-separated-list__title">Хабы:</span><ul class="tm-separated-list__list"><!--[--><li class="tm-separated-list__item"><!--[--><a href="/ru/companies/tbank/articles/" class="tm-hubs-list__link"><!--[--><span>Блог компании Т-Банк</span><!--]--></a><!--]--></li><li class="tm-separated-list__item"><!--[--><a href="/ru/hubs/android_dev/" class="tm-hubs-list__link"><!--[--><span>Разработка под Android</span><!--]--></a><!--]--></li><li class="tm-separated-list__item"><!--[--><a href="/ru/hubs/kotlin/" class="tm-hubs-list__link"><!--[--><span>Kotlin</span><!--]--></a><!--]--></li><li class="tm-separated-list__item"><!--[--><a href="/ru/hubs/gradle/" class="tm-hubs-list__link"><!--[--><span>Gradle</span><!--]--></a><!--]--></li><!--]--><!----></ul></div></div><!----><!--]--></article><!--]--></div><!----></div><div style="" class="tm-article-sticky-panel" data-test-id="article-sticky-panel"><div class="tm-data-icons tm-data-icons tm-data-icons_space-big tm-article-sticky-panel__icons" data-test-id="article-stats-icons"><div class="tm-article-rating tm-data-icons__item"><div class="tm-votes-meter tm-article-rating__votes-switcher"><svg class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-article" height="24" width="24"><title>Всего голосов 5: ↑5 и ↓0</title><use xlink:href="/img/megazord-v28.371b7fa3..svg#counter-rating"></use></svg><span class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_appearance-article tm-votes-meter__value_rating tm-votes-meter__value" data-test-id="votes-meter-value" title="Всего голосов 5: ↑5 и ↓0">+7</span></div><!--teleport start--><!--teleport end--><!----></div><!----><!----><button class="bookmarks-button tm-data-icons__item" title="Добавить в закладки" type="button"><span class="tm-svg-icon__wrapper bookmarks-button__icon"><svg class="tm-svg-img tm-svg-icon" height="24" width="24"><title>Добавить в закладки</title><use xlink:href="/img/megazord-v28.371b7fa3..svg#counter-favorite"></use></svg></span><span class="bookmarks-button__counter" title="Количество пользователей, добавивших публикацию в закладки">17</span></button><div class="tm-sharing tm-data-icons__item" title="Поделиться"><button class="tm-sharing__button" type="button"><svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="tm-sharing__icon"><path fill="currentColor" d="M13.8 13.8V18l7.2-6.6L13.8 5v3.9C5 8.9 3 18.6 3 18.6c2.5-4.4 6-4.8 10.8-4.8z"></path></svg></button><!--teleport start--><!--teleport end--></div><div class="tm-article-comments-counter-link tm-data-icons__item" title="Читать комментарии"><a href="/ru/companies/tbank/articles/843662/comments/" class="tm-article-comments-counter-link__link" data-test-id="counter-comments"><!--[--><svg class="tm-svg-img tm-article-comments-counter-link__icon" height="24" width="24"><title>Комментарии</title><use xlink:href="/img/megazord-v28.371b7fa3..svg#counter-comments"></use></svg><span class="tm-article-comments-counter-link__value">5</span><!--]--></a><!----></div><!--[--><!--[--><!--[--><!----><!--]--><!--]--><!--]--><!--teleport start--><!--teleport end--><!----></div></div></div><!--[--><!--]--><div class="tm-article-presenter__footer"><!--[--><!--[--><div class="tm-article-blocks"><!----><!--[--><section class="tm-block tm-block tm-block_spacing-bottom"><!----><!--[--><div class="tm-block__body tm-block__body tm-block__body_variant-balanced"><!--[--><div class="tm-article-author" data-test-id="article-author-info" data-async-called="true"><!--[--><!--[--><div class="tm-article-author__company"><div class="tm-article-author__company-card"><div class="tm-company-snippet"><a href="/ru/companies/tbank/profile/" class="tm-company-snippet__logo-link"><div class="tm-entity-image"><img alt="" class="tm-entity-image__pic" height="40" src="//habrastorage.org/getpro/habr/company/67a/1f6/e4d/67a1f6e4dd9929d4fbb91d9c6ada568d.png" width="40"></div></a><div class="tm-company-snippet__info"><a href="/ru/companies/tbank/profile/" class="tm-company-snippet__title" data-test-id="company-title"><span>Т-Банк</span></a><div class="tm-company-snippet__description">Компания</div></div></div><div class="tm-article-author__buttons"><!----><!----></div></div><!----><div class="tm-article-author__separator"></div></div><!--]--><!--]--><div class="tm-user-card tm-user-card tm-user-card_variant-article tm-article-author__user-card" data-async-called="true"><div class="tm-user-card__info-container"><div class="tm-user-card__header"><div class="tm-user-card__header-data"><a href="/ru/users/dkotikov/" class="tm-user-card__userpic tm-user-card__userpic_size-40"><div class="tm-entity-image"><!--[--><img alt="" class="tm-entity-image__pic" src="https://assets.habr.com/habr-web/img/avatars/076.png"><!--]--></div></a><div class="tm-user-card__meta"><div class="tm-counter-container tm-karma tm-karma" title=" 12 голосов "><div class="tm-counter-container__header"><!--[--><div class="karma-display positive" data-v-7635202e>12</div><!----><!--]--></div><div class="tm-counter-container__footer"><!--[--><div class="tm-karma__text">Карма</div><!--teleport start--><!--teleport end--><!--]--></div></div><div class="tm-counter-container" title="Рейтинг пользователя"><div class="tm-counter-container__header"><!--[--><!--[--><!--]--><div class="tm-votes-lever tm-votes-lever tm-votes-lever_appearance-rating"><!----><div class="tm-votes-lever__score tm-votes-lever__score_appearance-rating tm-votes-lever__score"><!--[--><span><span class="tm-votes-lever__score-counter tm-votes-lever__score-counter_rating tm-votes-lever__score-counter" data-test-id="votes-score-counter">29</span></span><!--]--></div><!----></div><!--]--></div><div class="tm-counter-container__footer"><!--[--><span class="tm-rating__text tm-rating__text">Рейтинг</span><!--]--></div></div></div></div></div><div class="tm-user-card__info tm-user-card__info_variant-article tm-user-card__info"><div class="tm-user-card__title tm-user-card__title_variant-article tm-user-card__title"><span class="tm-user-card__name tm-user-card__name_variant-article tm-user-card__name">Дмитрий</span><a href="/ru/users/dkotikov/" class="tm-user-card__nickname tm-user-card__nickname tm-user-card__nickname_variant-article"> @dkotikov</a><!----></div><p class="tm-user-card__short-info tm-user-card__short-info_variant-article tm-user-card__short-info" data-test-id="user-card-speciality">Пользователь</p></div></div><!----><div class="tm-user-card__buttons tm-user-card__buttons_variant-article tm-user-card__buttons"><!----><div class="tm-user-card__button"><div class="tm-button-follow tm-user-card__button-follow"><!----><button class="tm-button-follow__button tm-button-follow__button_big" data-test-id="follow-button" type="button">Подписаться</button></div></div><!----><div class="tm-user-card__button tm-user-card__button_write" data-test-id="user-card-conversations"><svg class="tm-svg-img tm-user-card__button-icon" height="16" width="16"><title>Отправить сообщение</title><use xlink:href="/img/megazord-v28.371b7fa3..svg#mail"></use></svg></div><!----></div><!----></div><div class="tm-article-author__user-contacts" data-test-id="author-contacts"><!----><!----><!----></div></div><!--]--></div><!--]--><!----></section><!----><!--[--><!--]--><!--]--><div class="tm-article-blocks__comments"><div id="publication-comments" class="tm-article-page-comments"><div><!--[--><div class="tm-article-comments-counter-link tm-article-comments-counter-button"><a href="/ru/companies/tbank/articles/843662/comments/" class="tm-article-comments-counter-link__link tm-article-comments-counter-link__link_button-style" data-test-id="counter-comments"><!--[--><svg class="tm-svg-img tm-article-comments-counter-link__icon tm-article-comments-counter-link__icon_contrasted" height="24" width="24"><title>Комментарии</title><use xlink:href="/img/megazord-v28.371b7fa3..svg#counter-comments"></use></svg><span class="tm-article-comments-counter-link__value tm-article-comments-counter-link__value_contrasted"> Комментарии 5 </span><!--]--></a><!----></div><!--]--></div></div></div><!--[--><!--[--><!--]--><section class="tm-block tm-block tm-block_spacing-bottom"><header class="tm-block__header tm-block__header tm-block__header_variant-borderless"><div class="tm-block__header-container"><h2 class="tm-block__title tm-block__title tm-block__title_variant-large">Публикации</h2><!--[--><!--]--></div><!----></header><!--[--><div class="tm-block__body tm-block__body tm-block__body_variant-condensed-slim"><!--[--><!--[--><div class="tm-tabs tm-tabs"><div class=""><!--[--><span class="tm-tabs__tab-item"><button class="tm-tabs__tab-link tm-tabs__tab-link_active tm-tabs__tab-link_slim tm-tabs__tab-link">Лучшие за сутки</button></span><span class="tm-tabs__tab-item"><button class="tm-tabs__tab-link tm-tabs__tab-link_slim tm-tabs__tab-link">Похожие</button></span><!--]--></div><!----></div><div class="similar-and-daily__tab-view"><div class="placeholder-wrapper"><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><div class="tm-placeholder-article-cards"><!--[--><div class="tm-placeholder-article-card"><div class="tm-placeholder__user"><div class="tm-placeholder__user-pic loads"></div><div class="tm-placeholder__user-date loads"></div></div><div class="tm-placeholder-article-card__title"><div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div><div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div></div><div class="tm-placeholder-article-card__icons tm-placeholder__counters"><!--[--><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div><div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div><div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div><div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div><div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><!--]--></div></div><div class="tm-placeholder-article-card"><div class="tm-placeholder__user"><div class="tm-placeholder__user-pic loads"></div><div class="tm-placeholder__user-date loads"></div></div><div class="tm-placeholder-article-card__title"><div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div><div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div></div><div class="tm-placeholder-article-card__icons tm-placeholder__counters"><!--[--><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div><div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div><div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div><div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div><div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><!--]--></div></div><div class="tm-placeholder-article-card"><div class="tm-placeholder__user"><div class="tm-placeholder__user-pic loads"></div><div class="tm-placeholder__user-date loads"></div></div><div class="tm-placeholder-article-card__title"><div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div><div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div></div><div class="tm-placeholder-article-card__icons tm-placeholder__counters"><!--[--><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div><div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div><div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div><div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div><div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><!--]--></div></div><div class="tm-placeholder-article-card"><div class="tm-placeholder__user"><div class="tm-placeholder__user-pic loads"></div><div class="tm-placeholder__user-date loads"></div></div><div class="tm-placeholder-article-card__title"><div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div><div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div></div><div class="tm-placeholder-article-card__icons tm-placeholder__counters"><!--[--><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div><div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div><div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div><div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div><div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><!--]--></div></div><div class="tm-placeholder-article-card"><div class="tm-placeholder__user"><div class="tm-placeholder__user-pic loads"></div><div class="tm-placeholder__user-date loads"></div></div><div class="tm-placeholder-article-card__title"><div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div><div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div></div><div class="tm-placeholder-article-card__icons tm-placeholder__counters"><!--[--><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div><div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div><div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div><div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div><div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><!--]--></div></div><!--]--></div><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----></div><!----></div><!--]--><!--]--></div><!--]--><!----></section><!--[--><!--[--><div class="placeholder-wrapper"><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><div class="tm-placeholder-inset tm-placeholder-vacancies"><div class="tm-placeholder-inset__header"><div class="tm-placeholder__line tm-placeholder__line_inset-header loads"></div></div><div class="tm-placeholder-inset__body"><ul class="tm-placeholder-list"><!--[--><li class="tm-placeholder-list__item tm-placeholder-list__item_inset"><div class="tm-placeholder-list__title-container"><div class="tm-placeholder__line tm-placeholder__line_item-title loads"></div></div><div class="tm-project-block-items__properties"><!--[--><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width:100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width:100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width:100px;"></span></span><!--]--></div></li><li class="tm-placeholder-list__item tm-placeholder-list__item_inset"><div class="tm-placeholder-list__title-container"><div class="tm-placeholder__line tm-placeholder__line_item-title loads"></div></div><div class="tm-project-block-items__properties"><!--[--><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width:100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width:100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width:100px;"></span></span><!--]--></div></li><li class="tm-placeholder-list__item tm-placeholder-list__item_inset"><div class="tm-placeholder-list__title-container"><div class="tm-placeholder__line tm-placeholder__line_item-title loads"></div></div><div class="tm-project-block-items__properties"><!--[--><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width:100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width:100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width:100px;"></span></span><!--]--></div></li><li class="tm-placeholder-list__item tm-placeholder-list__item_inset"><div class="tm-placeholder-list__title-container"><div class="tm-placeholder__line tm-placeholder__line_item-title loads"></div></div><div class="tm-project-block-items__properties"><!--[--><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width:100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width:100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width:100px;"></span></span><!--]--></div></li><li class="tm-placeholder-list__item tm-placeholder-list__item_inset"><div class="tm-placeholder-list__title-container"><div class="tm-placeholder__line tm-placeholder__line_item-title loads"></div></div><div class="tm-project-block-items__properties"><!--[--><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width:100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width:100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width:100px;"></span></span><!--]--></div></li><!--]--></ul></div><div class="tm-placeholder-inset__footer"><div class="tm-placeholder__line tm-placeholder__line_inset-footer loads"></div></div></div><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----></div><!--]--><!--]--><!----><!--[--><!--]--><!--]--></div><!--]--><!--]--></div></div><!--]--><!--]--></div></div><div class="tm-page__sidebar"><!--[--><!----><!--]--></div></div><!----><!--]--></div></div></main><!----></div><!----><div class="tm-footer"><div class="tm-page-width"><!--[--><div class="tm-footer__container"><div class="tm-footer__title"><a class="tm-svg-icon__wrapper tm-footer__title-link" href="/ru/"><svg class="tm-svg-img tm-svg-icon" height="16" width="16"><title>Хабр</title><use xlink:href="/img/habr-logo-ru.svg#logo"></use></svg></a></div><div class="tm-footer__social"><!--[--><a class="tm-svg-icon__wrapper tm-social-icons__icon" href="https://www.facebook.com/habrahabr.ru" rel="nofollow noopener noreferrer" target="_blank"><svg class="tm-svg-img tm-svg-icon" height="36" width="36"><title>Facebook</title><use xlink:href="/img/new-social-icons-sprite.svg#social-logo-facebook"></use></svg></a><a class="tm-svg-icon__wrapper tm-social-icons__icon" href="https://twitter.com/habr_com" rel="nofollow noopener noreferrer" target="_blank"><svg class="tm-svg-img tm-svg-icon" height="36" width="36"><title>Twitter</title><use xlink:href="/img/new-social-icons-sprite.svg#social-logo-twitter"></use></svg></a><a class="tm-svg-icon__wrapper tm-social-icons__icon" href="https://vk.com/habr" rel="nofollow noopener noreferrer" target="_blank"><svg class="tm-svg-img tm-svg-icon" height="36" width="36"><title>VK</title><use xlink:href="/img/new-social-icons-sprite.svg#social-logo-vk"></use></svg></a><a class="tm-svg-icon__wrapper tm-social-icons__icon" href="https://telegram.me/habr_com" rel="nofollow noopener noreferrer" target="_blank"><svg class="tm-svg-img tm-svg-icon" height="36" width="36"><title>Telegram</title><use xlink:href="/img/new-social-icons-sprite.svg#social-logo-telegram"></use></svg></a><a class="tm-svg-icon__wrapper tm-social-icons__icon" href="https://www.youtube.com/channel/UCd_sTwKqVrweTt4oAKY5y4w" rel="nofollow noopener noreferrer" target="_blank"><svg class="tm-svg-img tm-svg-icon" height="36" width="36"><title>Youtube</title><use xlink:href="/img/new-social-icons-sprite.svg#social-logo-youtube"></use></svg></a><a class="tm-svg-icon__wrapper tm-social-icons__icon" href="https://dzen.ru/habr" rel="nofollow noopener noreferrer" target="_blank"><svg class="tm-svg-img tm-svg-icon" height="36" width="36"><title>Яндекс Дзен</title><use xlink:href="/img/new-social-icons-sprite.svg#social-logo-dzen"></use></svg></a><!--]--></div><!--teleport start--><!--teleport end--><button class="tm-footer__link"><svg class="tm-svg-img tm-footer__icon" height="16" width="16"><title>Язык</title><use xlink:href="/img/megazord-v28.371b7fa3..svg#lang"></use></svg> Настройка языка</button><a href="/ru/feedback/" class="tm-footer__link">Техническая поддержка</a><div class="tm-footer-copyright"><span class="tm-copyright"><span class="tm-copyright__years">© 2006–2025, </span><span class="tm-copyright__name"><a class="tm-copyright__link" href="https://company.habr.com/" rel="noopener" target="_blank">Habr</a></span></span></div></div><!--]--></div></div><!----><!--]--></div><!----></div><script>window.__INITIAL_STATE__={"adblock":{"hasAcceptableAdsFilter":false,"hasAdblock":false},"articlesList":{"articlesList":{"843662":{"id":"843662","timePublished":"2024-09-19T07:20:51+00:00","isCorporative":true,"lang":"ru","titleHtml":"Создание плагинов и переиспользуемых частей в .gradle.kts-файлах и Kotlin extension-функциях","leadData":{"textHtml":"\u003Cp\u003EВсем привет! На связи Дима Котиков, и мы продолжаем разговор о том, как облегчить себе жизнь и уменьшить Boilerplate в gradle-файлах. \u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompanies\u002Ftbank\u002Farticles\u002F843648\u002F\"\u003EВ первой части\u003C\u002Fa\u003E поговорили о том, как подготовиться к созданию модулей для Gradle Convention Plugin. Двигаемся дальше!\u003C\u002Fp\u003E\u003Cp\u003E\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F5db\u002Fb11\u002Fe8b\u002F5dbb11e8b34998877497f928b873049a.jpg","buttonTextHtml":"Читать далее","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F5db\u002Fb11\u002Fe8b\u002F5dbb11e8b34998877497f928b873049a.jpg","fit":"cover","positionY":0,"positionX":0}},"editorVersion":"2.0","postType":"article","postLabels":[],"author":{"id":"4475550","alias":"dkotikov","fullname":"Дмитрий","avatarUrl":null,"speciality":null,"scoreStats":{"score":12,"votesCount":12},"rating":29,"relatedData":null,"contacts":[],"authorContacts":[],"paymentDetails":{"paymentYandexMoney":null,"paymentPayPalMe":null,"paymentWebmoney":null},"donationsMethod":null,"isInBlacklist":null,"careerProfile":null},"statistics":{"commentsCount":5,"favoritesCount":17,"readingCount":3724,"score":7,"votesCount":5,"votesCountPlus":5,"votesCountMinus":0},"hubs":[{"id":"17420","alias":"tbank","type":"corporative","title":"Блог компании Т-Банк","titleHtml":"Блог компании Т-Банк","isProfiled":false,"relatedData":null},{"id":"17107","alias":"android_dev","type":"collective","title":"Разработка под Android","titleHtml":"Разработка под Android","isProfiled":true,"relatedData":null},{"id":"19441","alias":"kotlin","type":"collective","title":"Kotlin","titleHtml":"Kotlin","isProfiled":true,"relatedData":null},{"id":"21372","alias":"gradle","type":"collective","title":"Gradle","titleHtml":"Gradle","isProfiled":true,"relatedData":null}],"flows":[{"id":"1","alias":"develop","title":"Разработка","titleHtml":"Разработка"}],"relatedData":{"vote":null,"unreadCommentsCount":0,"bookmarked":false,"canComment":false,"canEdit":false,"canViewVotes":false,"votePlus":{"canVote":false,"isChargeEnough":false,"isKarmaEnough":false,"isVotingOver":true,"isPublicationLimitEnough":false},"voteMinus":{"canVote":false,"isChargeEnough":false,"isKarmaEnough":false,"isVotingOver":true,"isPublicationLimitEnough":false},"canModerateComments":false,"trackerSubscribed":false,"emailSubscribed":false},"textHtml":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003E\u003Cfigure class=\"full-width \"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw780q1\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fd29\u002F4ab\u002F179\u002Fd294ab179d9d24fe32e62ca32ea1d55f.jpg\" width=\"1560\" height=\"880\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fd29\u002F4ab\u002F179\u002Fd294ab179d9d24fe32e62ca32ea1d55f.jpg\" data-blurred=\"true\"\u002F\u003E\u003C\u002Ffigure\u003E\u003Cp\u003EВсем привет! На связи Дима Котиков, и мы продолжаем разговор о том, как облегчить себе жизнь и уменьшить Boilerplate в gradle-файлах. \u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompanies\u002Ftbank\u002Farticles\u002F843648\u002F\"\u003EВ первой части\u003C\u002Fa\u003E поговорили о том, как подготовиться к созданию модулей для Gradle Convention Plugin. Двигаемся дальше!\u003C\u002Fp\u003E\u003Ch2\u003EСоздание базовых Convention Plugins и extension-функций\u003C\u002Fh2\u003E\u003Cp\u003EНачнем с создания базовой конфигурации для android-таргета, но перед этим добавим \u003Ccode\u003EminSdk\u003C\u002Fcode\u003E, \u003Ccode\u003EtargetSdk\u003C\u002Fcode\u003E и \u003Ccode\u003EcompileSdk\u003C\u002Fcode\u003E в \u003Ccode\u003Elibs.versions.toml\u003C\u002Fcode\u003E для того, чтобы была возможность изменять эти значения в одном месте сразу для всех модулей.\u003C\u002Fp\u003E\u003Cfigure class=\"full-width \"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw1560\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F7ac\u002F297\u002Ffd1\u002F7ac297fd1b3a47247b11ba16145a2b14.png\" alt=\"Добавление minSdk, targetSdk и compileSdk в libs.versions.toml\" title=\"Добавление minSdk, targetSdk и compileSdk в libs.versions.toml\" width=\"1600\" height=\"952\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F7ac\u002F297\u002Ffd1\u002F7ac297fd1b3a47247b11ba16145a2b14.png\"\u002F\u003E\u003Cdiv\u003E\u003Cfigcaption\u003EДобавление \u003Ccode\u003EminSdk\u003C\u002Fcode\u003E, \u003Ccode\u003EtargetSdk\u003C\u002Fcode\u003E и \u003Ccode\u003EcompileSdk\u003C\u002Fcode\u003E в \u003Ccode\u003Elibs.versions.toml\u003C\u002Fcode\u003E\u003C\u002Ffigcaption\u003E\u003C\u002Fdiv\u003E\u003C\u002Ffigure\u003E\u003Cp\u003EСравним конфигурации для \u003Ccode\u003EcomposeApp\u003C\u002Fcode\u003E и \u003Ccode\u003Eshared-uikit\u003C\u002Fcode\u003E модулей:\u003C\u002Fp\u003E\u003Cfigure class=\"full-width \"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw1560\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Ff07\u002F5f6\u002F218\u002Ff075f6218a724ecc783568074bf2ec04.png\" alt=\"Сравнение android-конфигураций для app- и library-модулей\" title=\"Сравнение android-конфигураций для app- и library-модулей\" width=\"1600\" height=\"911\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Ff07\u002F5f6\u002F218\u002Ff075f6218a724ecc783568074bf2ec04.png\"\u002F\u003E\u003Cdiv\u003E\u003Cfigcaption\u003EСравнение android-конфигураций для app- и library-модулей\u003C\u002Ffigcaption\u003E\u003C\u002Fdiv\u003E\u003C\u002Ffigure\u003E\u003Cp\u003EКакие общие части можно выделить:\u003C\u002Fp\u003E\u003Cfigure class=\"full-width \"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw1560\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F128\u002F329\u002F864\u002F1283298641429445bee06321cd640616.png\" alt=\"Общие части android-конфигураций\" title=\"Общие части android-конфигураций\" width=\"1600\" height=\"1005\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F128\u002F329\u002F864\u002F1283298641429445bee06321cd640616.png\"\u002F\u003E\u003Cdiv\u003E\u003Cfigcaption\u003EОбщие части android-конфигураций\u003C\u002Ffigcaption\u003E\u003C\u002Fdiv\u003E\u003C\u002Ffigure\u003E\u003Cp\u003EВидим, что выделенные стрелками и блоками части абсолютно идентичны и мы можем вынести их в общую конфигурацию. Для этого нам сначала нужно взглянуть на функцию \u003Ccode\u003Eandroid\u003C\u002Fcode\u003E и посмотреть контекст, на котором выполняется логика. Проваливаемся в функции \u003Ccode\u003Eandroid\u003C\u002Fcode\u003E наших модулей и видим проблемку: для app- и library-модуля \u003Cabbr class=\"habraabbr\" title=\"А также функция android не доступна в gradle-файлах без подключения плагина com.android.application или com.android.library\" data-title=\"&lt;p&gt;А также функция &lt;code&gt;android&lt;\u002Fcode&gt; не доступна в gradle-файлах без подключения плагина &lt;code&gt;com.android.application&lt;\u002Fcode&gt; или &lt;code&gt;com.android.library&lt;\u002Fcode&gt;&lt;\u002Fp&gt;&lt;p&gt;&lt;\u002Fp&gt;\" data-abbr=\"функция android конфигурирует немного разные сущности\"\u003Eфункция android конфигурирует немного разные сущности\u003C\u002Fabbr\u003E.\u003C\u002Fp\u003E\u003Cfigure class=\"full-width \"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw1560\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F67e\u002F6b6\u002F5af\u002F67e6b65afa6ff4c88ce317f7294e02b3.png\" alt=\"Разные типы Actions в Extension Android для app- и library-модулей\" title=\"Разные типы Actions в Extension Android для app- и library-модулей\" width=\"1600\" height=\"433\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F67e\u002F6b6\u002F5af\u002F67e6b65afa6ff4c88ce317f7294e02b3.png\"\u002F\u003E\u003Cdiv\u003E\u003Cfigcaption\u003EРазные типы Actions в Extension Android для app- и library-модулей\u003C\u002Ffigcaption\u003E\u003C\u002Fdiv\u003E\u003C\u002Ffigure\u003E\u003Ch2\u003EЧто же теперь делать\u003C\u002Fh2\u003E\u003Cfigure class=\"full-width \"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw1560\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F72d\u002F8a7\u002Fab8\u002F72d8a7ab8a7f76683b75c3a940d3fbad.png\" width=\"1001\" height=\"793\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F72d\u002F8a7\u002Fab8\u002F72d8a7ab8a7f76683b75c3a940d3fbad.png\"\u002F\u003E\u003C\u002Ffigure\u003E\u003Cp\u003EНужно копнуть глубже и найти, что \u003Ccode\u003EBaseAppModuleExtension\u003C\u002Fcode\u003E и \u003Ccode\u003ELibraryExtension\u003C\u002Fcode\u003E наследуются от одного интерфейса \u003Ccode\u003ECommonExtension&lt;BuildFeaturesT : BuildFeatures, BuildTypeT : BuildType, DefaultConfigT : DefaultConfig, ProductFlavorT : ProductFlavor, AndroidResourcesT : AndroidResources&gt;\u003C\u002Fcode\u003E. Его и будем использовать для обобщения android-конфигурации. \u003C\u002Fp\u003E\u003Cp\u003EНо перед написанием Convention Plugin сделаем пару удобных Extensions. Создаем файл \u003Ccode\u003EBaseExtensions.kt\u003C\u002Fcode\u003E и добавляем следующее:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"kotlin\"\u003Epackage io.github.dmitriy1892.conventionplugins.base.extensions\n \nimport com.android.build.api.dsl.AndroidResources\nimport com.android.build.api.dsl.BuildFeatures\nimport com.android.build.api.dsl.BuildType\nimport com.android.build.api.dsl.CommonExtension\nimport com.android.build.api.dsl.DefaultConfig\nimport com.android.build.api.dsl.LibraryExtension\nimport com.android.build.api.dsl.ProductFlavor\nimport com.android.build.gradle.internal.dsl.BaseAppModuleExtension\nimport org.gradle.api.Project\nimport org.gradle.kotlin.dsl.findByType\nimport org.gradle.kotlin.dsl.withType\nimport org.jetbrains.kotlin.gradle.dsl.KotlinJvmCompilerOptions\nimport org.jetbrains.kotlin.gradle.tasks.KotlinJvmCompile\n \nprivate typealias AndroidExtensions = CommonExtension&lt;\n        out BuildFeatures,\n        out BuildType,\n        out DefaultConfig,\n        out ProductFlavor,\n        out AndroidResources&gt;\n \nprivate val Project.androidExtension: AndroidExtensions\n    get() = extensions.findByType(BaseAppModuleExtension::class)\n        ?: extensions.findByType(LibraryExtension::class)\n        ?: error(\n            \"\\\"Project.androidExtension\\\" value may be called only from android application\" +\n                    \" or android library gradle script\"\n        )\n \nfun Project.androidConfig(block: AndroidExtensions.() -&gt; Unit): Unit = block(androidExtension)\n \nfun Project.kotlinJvmCompilerOptions(block: KotlinJvmCompilerOptions.() -&gt; Unit) {\n    tasks.withType&lt;KotlinJvmCompile&gt;().configureEach {\n\t    compilerOptions(block)\n    }\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EМы объявили typealias \u003Ccode\u003EAndroidExtensions\u003C\u002Fcode\u003E для интерфейса \u003Ccode\u003ECommonExtension\u003C\u002Fcode\u003E, чтобы не писать все Generic из раза в раз.\u003C\u002Fp\u003E\u003Cp\u003EВ extension-поле \u003Ccode\u003EProject.androidExtension\u003C\u002Fcode\u003E обращаемся к \u003Ccode\u003Eextensions\u003C\u002Fcode\u003E нашего gradle-проекта и пытаемся найти \u003Ccode\u003EBaseAppModuleExtension\u003C\u002Fcode\u003E или \u003Ccode\u003ELibraryExtension\u003C\u002Fcode\u003E, которые являются наследниками интерфейса \u003Ccode\u003ECommonExtension\u003C\u002Fcode\u003E.\u003C\u002Fp\u003E\u003Cp\u003EВ функции \u003Ccode\u003EProject.androidConfig\u003C\u002Fcode\u003E предоставляем лямбду \u003Ccode\u003Eblock\u003C\u002Fcode\u003E с контекстом на \u003Ccode\u003EAndroidExtensions\u003C\u002Fcode\u003E. Теперь при использовании этой функции мы сможем задавать android-specific-конфигурации.\u003C\u002Fp\u003E\u003Cp\u003EВ функции \u003Ccode\u003EProject.kotlinJvmCompilerOptions\u003C\u002Fcode\u003E мы ищем таску \u003Ccode\u003EKotlinJvmCompile\u003C\u002Fcode\u003E для того, чтобы предоставить возможность сконфигурировать в лямбде \u003Ccode\u003Eblock\u003C\u002Fcode\u003E параметры kotlin-компилятора под JVM-таргет.\u003C\u002Fp\u003E\u003Cp\u003EДалее создаем файл \u003Ccode\u003Eandroid.base.config.gradle.kts\u003C\u002Fcode\u003E, пытаемся сконфигурировать и натыкаемся на то, что version catalog недоступен в нашем Convention Plugin.\u003C\u002Fp\u003E\u003Cfigure class=\"full-width \"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw1560\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F7eb\u002F187\u002F480\u002F7eb187480038e6156bc791ff01a0404e.png\" alt=\"Version Catalog недоступен\" title=\"Version Catalog недоступен\" width=\"1600\" height=\"675\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F7eb\u002F187\u002F480\u002F7eb187480038e6156bc791ff01a0404e.png\"\u002F\u003E\u003Cdiv\u003E\u003Cfigcaption\u003EVersion Catalog недоступен\u003C\u002Ffigcaption\u003E\u003C\u002Fdiv\u003E\u003C\u002Ffigure\u003E\u003Cp\u003EВ предыдущем разделе в файле \u003Ccode\u003Ebuild.gradle.kts\u003C\u002Fcode\u003E мы указывали workaround для того, чтобы работали Version Catalogs —  но этого нам недостаточно. Чтобы Version Catalogs у нас заработали, напишем еще один extension. Идем в файл \u003Ccode\u003EBaseExtensions.kt\u003C\u002Fcode\u003E и добавляем такой код:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"kotlin\"\u003Epackage io.github.dmitriy1892.conventionplugins.base.extensions\n \n import org.gradle.accessors.dm.LibrariesForLibs\n import org.gradle.api.Project\n import org.gradle.kotlin.dsl.the\n \n... \n val Project.libs: LibrariesForLibs\n     get() = the&lt;LibrariesForLibs&gt;()\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EДля удобства в этом же файле добавим extension на получение версии Java, он понадобится в нескольких местах. Итого получаем:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"kotlin\"\u003E package io.github.dmitriy1892.conventionplugins.base.extensions\n  \n import org.gradle.accessors.dm.LibrariesForLibs\n import org.gradle.api.JavaVersion\n import org.gradle.api.Project\n import org.gradle.kotlin.dsl.the\n  \n val Project.libs: LibrariesForLibs\n     get() = the&lt;LibrariesForLibs&gt;()\n  \n val Project.projectJavaVersion: JavaVersion\n     get() = JavaVersion.toVersion(libs.versions.java.get().toInt())\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EВозвращаемся к \u003Ccode\u003Eandroid.base.config.gradle.kts\u003C\u002Fcode\u003E и конфигурируем, не забывая про импорты наших extension-функций:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"kotlin\"\u003Eimport io.github.dmitriy1892.conventionplugins.base.extensions.androidConfig\nimport io.github.dmitriy1892.conventionplugins.base.extensions.kotlinJvmCompilerOptions\nimport io.github.dmitriy1892.conventionplugins.base.extensions.libs\nimport io.github.dmitriy1892.conventionplugins.base.extensions.projectJavaVersion\nimport org.jetbrains.kotlin.gradle.dsl.JvmTarget\n \nandroidConfig {\n    compileSdk = libs.versions.compileSdk.get().toInt()\n \n    defaultConfig {\n        minSdk = libs.versions.minSdk.get().toInt()\n    }\n \n    sourceSets[\"main\"].apply {\n        manifest.srcFile(\"src\u002FandroidMain\u002FAndroidManifest.xml\")\n        res.srcDirs(\"src\u002FandroidMain\u002Fres\")\n    }\n \n    compileOptions {\n        sourceCompatibility = JavaVersion.VERSION_1_8\n        targetCompatibility = JavaVersion.VERSION_1_8\n    }\n}\n \nkotlinJvmCompilerOptions {\n    jvmTarget.set(JvmTarget.fromTarget(projectJavaVersion.toString()))\n    freeCompilerArgs.add(\"-Xjdk-release=${projectJavaVersion}\")\n}\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EОткуда взялся блок \u003Ccode\u003EkotlinJvmCompilerOptions\u003C\u002Fcode\u003E и зачем он нам? Если мы посмотрим еще раз на файлы \u003Ccode\u003Ebuild.gradle.kts\u003C\u002Fcode\u003E  в модулях \u003Ccode\u003EcomposeApp\u003C\u002Fcode\u003E и \u003Ccode\u003Eshared-uikit\u003C\u002Fcode\u003E, в блоке \u003Ccode\u003Ekotlin\u003C\u002Fcode\u003E увидим следующее:\u003C\u002Fp\u003E\u003Cfigure class=\"full-width \"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw1560\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fcc8\u002F0a7\u002Fc67\u002Fcc80a7c67ea0d645da20e2aa55ba6e18.png\" alt=\"Общие части в build.gradle.kts-файлах модулей composeApp и shared-uikit\" title=\"Общие части в build.gradle.kts-файлах модулей composeApp и shared-uikit\" width=\"1600\" height=\"602\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fcc8\u002F0a7\u002Fc67\u002Fcc80a7c67ea0d645da20e2aa55ba6e18.png\"\u002F\u003E\u003Cdiv\u003E\u003Cfigcaption\u003EОбщие части в \u003Ccode\u003Ebuild.gradle.kts\u003C\u002Fcode\u003E-файлах модулей \u003Ccode\u003EcomposeApp\u003C\u002Fcode\u003E и \u003Ccode\u003Eshared-uikit\u003C\u002Fcode\u003E\u003C\u002Ffigcaption\u003E\u003C\u002Fdiv\u003E\u003C\u002Ffigure\u003E\u003Cp\u003EКак видим на картинке, в выделенных красным блоках конфигурируются настройки компилятора для android-таргета. По этой причине мы и вынесли их в файл  \u003Ccode\u003Eandroid.base.config.gradle.kts\u003C\u002Fcode\u003E, предварительно настроив extension-функцию в \u003Ccode\u003EBaseExtensions.kt\u003C\u002Fcode\u003E .\u003C\u002Fp\u003E\u003Cp\u003EПрименяем в \u003Ccode\u003Ebuild.gradle.kts\u003C\u002Fcode\u003E-файлах модулей наш Convention Plugin и удаляем блоки кода, которые уже есть в \u003Ccode\u003Eandroid.base.config.gradle.kts\u003C\u002Fcode\u003E. Скриншоты приложил только для модуля \u003Ccode\u003Eshared-uikit\u003C\u002Fcode\u003E, но такие же правки проведены и в \u003Ccode\u003EcomposeApp\u003C\u002Fcode\u003E.\u003C\u002Fp\u003E\u003Cfigure class=\"full-width \"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw1560\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F215\u002F080\u002F76b\u002F21508076bf5dab60685506dcf5745281.png\" alt=\"Добавление Convention Plugin в shared-uikit\u002Fbuild.gradle.kts и удаление кода настроек компилятора\" title=\"Добавление Convention Plugin в shared-uikit\u002Fbuild.gradle.kts и удаление кода настроек компилятора\" width=\"1600\" height=\"577\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F215\u002F080\u002F76b\u002F21508076bf5dab60685506dcf5745281.png\"\u002F\u003E\u003Cdiv\u003E\u003Cfigcaption\u003EДобавление Convention Plugin в \u003Ccode\u003Eshared-uikit\u002Fbuild.gradle.kts\u003C\u002Fcode\u003E и удаление кода настроек компилятора\u003C\u002Ffigcaption\u003E\u003C\u002Fdiv\u003E\u003C\u002Ffigure\u003E\u003Cfigure class=\"full-width \"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw1560\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F957\u002F9f2\u002F1cf\u002F9579f21cfaa6d2d8ecd5b7b5f3bb08da.png\" alt=\"Удаление кода из shared-uikit\u002Fbuild.gradle.kts. Добавили его выше в android.base.config.gradle.kts\" title=\"Удаление кода из shared-uikit\u002Fbuild.gradle.kts. Добавили его выше в android.base.config.gradle.kts\" width=\"1600\" height=\"542\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F957\u002F9f2\u002F1cf\u002F9579f21cfaa6d2d8ecd5b7b5f3bb08da.png\"\u002F\u003E\u003Cdiv\u003E\u003Cfigcaption\u003EУдаление кода из \u003Ccode\u003Eshared-uikit\u002Fbuild.gradle.kts\u003C\u002Fcode\u003E. Добавили его выше в \u003Ccode\u003Eandroid.base.config.gradle.kts\u003C\u002Fcode\u003E\u003C\u002Ffigcaption\u003E\u003C\u002Fdiv\u003E\u003C\u002Ffigure\u003E\u003Cp\u003EПытаемся синхронизироваться, и-и-и... Видим ошибку:\u003C\u002Fp\u003E\u003Cfigure class=\"full-width \"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw1560\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F765\u002F38b\u002Fef0\u002F76538bef03ce53d2dd86ffca7587506f.png\" alt=\"Ошибка синхронизации проекта после добавления Convention Plugin\" title=\"Ошибка синхронизации проекта после добавления Convention Plugin\" width=\"1600\" height=\"484\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F765\u002F38b\u002Fef0\u002F76538bef03ce53d2dd86ffca7587506f.png\"\u002F\u003E\u003Cdiv\u003E\u003Cfigcaption\u003EОшибка синхронизации проекта после добавления Convention Plugin\u003C\u002Ffigcaption\u003E\u003C\u002Fdiv\u003E\u003C\u002Ffigure\u003E\u003Cp\u003EОшибка появляется потому, что в плагине \u003Ccode\u003Eandroid.base.config.gradle.kts\u003C\u002Fcode\u003E мы добавили блок конфигурации базового android-проекта, но не добавляли плагин \u003Ccode\u003Ecom.android.application\u003C\u002Fcode\u003E или \u003Ccode\u003Ecom.android.library\u003C\u002Fcode\u003E. Gradle применяет наши плагины поочередно сверху вниз? и так как до Convention Plugin никакие другие плагины не применены, появилась ошибка.\u003C\u002Fp\u003E\u003Cp\u003EДостаточно указать Convention Plugin ниже android-плагина, чтобы исправить этот позорный недуг.\u003C\u002Fp\u003E\u003Cfigure class=\"full-width \"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw1560\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F32a\u002F8a7\u002Fc7a\u002F32a8a7c7a958041bbf56798f91a44462.png\" alt=\"Исправление ошибки сборки\" title=\"Исправление ошибки сборки\" width=\"1292\" height=\"520\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F32a\u002F8a7\u002Fc7a\u002F32a8a7c7a958041bbf56798f91a44462.png\"\u002F\u003E\u003Cdiv\u003E\u003Cfigcaption\u003EИсправление ошибки сборки\u003C\u002Ffigcaption\u003E\u003C\u002Fdiv\u003E\u003C\u002Ffigure\u003E\u003Cp\u003EСинхронизируемся, собираем проект — все заработало!\u003C\u002Fp\u003E\u003Cfigure class=\"full-width \"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw1560\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fb63\u002F5da\u002F329\u002Fb635da32904c134daa0d4a7f13b566dc.png\" alt=\"Успешная сборка\" title=\"Успешная сборка\" width=\"1600\" height=\"353\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fb63\u002F5da\u002F329\u002Fb635da32904c134daa0d4a7f13b566dc.png\"\u002F\u003E\u003Cdiv\u003E\u003Cfigcaption\u003EУспешная сборка\u003C\u002Ffigcaption\u003E\u003C\u002Fdiv\u003E\u003C\u002Ffigure\u003E\u003Cp\u003EДальше — больше, продолжаем выносить общую логику. Сконфигурируем тесты для android-таргета, в папке с плагинами создаем файл \u003Ccode\u003Eandroid.base.test.config.gradle.kts\u003C\u002Fcode\u003E, но перед его наполнением добавим еще Extensions для удобства.\u003C\u002Fp\u003E\u003Cp\u003EДля создания extension-функции для блока \u003Ccode\u003EandroidTarget\u003C\u002Fcode\u003E нам нужно посмотреть, как до нее можно добраться.\u003C\u002Fp\u003E\u003Cfigure class=\"full-width \"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw1560\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F997\u002Fbee\u002Fdb6\u002F997beedb64e9c90ab23a028971be7c5f.png\" alt=\"Блок androidTarget внутри блока kotlin\" title=\"Блок androidTarget внутри блока kotlin\" width=\"1600\" height=\"1040\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F997\u002Fbee\u002Fdb6\u002F997beedb64e9c90ab23a028971be7c5f.png\"\u002F\u003E\u003Cdiv\u003E\u003Cfigcaption\u003EБлок \u003Ccode\u003EandroidTarget\u003C\u002Fcode\u003E внутри блока kotlin\u003C\u002Ffigcaption\u003E\u003C\u002Fdiv\u003E\u003C\u002Ffigure\u003E\u003Cp\u003EПроваливаемся в функцию \u003Ccode\u003EandroidTarget\u003C\u002Fcode\u003E:\u003C\u002Fp\u003E\u003Cfigure class=\"full-width \"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw1560\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fe5b\u002F9e9\u002Fe04\u002Fe5b9e9e04fb4a57d33849ac092e6de9e.png\" alt=\"Функция androidTarget\" title=\"Функция androidTarget\" width=\"1600\" height=\"472\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fe5b\u002F9e9\u002Fe04\u002Fe5b9e9e04fb4a57d33849ac092e6de9e.png\"\u002F\u003E\u003Cdiv\u003E\u003Cfigcaption\u003EФункция androidTarget\u003C\u002Ffigcaption\u003E\u003C\u002Fdiv\u003E\u003C\u002Ffigure\u003E\u003Cp\u003EВидим, что функция \u003Ccode\u003EandroidTarget\u003C\u002Fcode\u003E — часть интерфейса \u003Ccode\u003EKotlinTargetContainerWithPresetFunctions\u003C\u002Fcode\u003E и что интерфейс реализуется классом \u003Ccode\u003EKotlinMultiplatformExtension\u003C\u002Fcode\u003E.\u003C\u002Fp\u003E\u003Cfigure class=\"full-width \"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw1560\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F426\u002F8a3\u002Fc9e\u002F4268a3c9e5ecb0a3ca7ce3d184f10f74.png\" alt=\"KotlinTargetContainerWithPresetFunctions реализуется классом KotlinMultiplatformExtension\" title=\"KotlinTargetContainerWithPresetFunctions реализуется классом KotlinMultiplatformExtension\" width=\"1600\" height=\"427\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F426\u002F8a3\u002Fc9e\u002F4268a3c9e5ecb0a3ca7ce3d184f10f74.png\"\u002F\u003E\u003Cdiv\u003E\u003Cfigcaption\u003E\u003Ccode\u003EKotlinTargetContainerWithPresetFunctions\u003C\u002Fcode\u003E реализуется классом \u003Ccode\u003EKotlinMultiplatformExtension\u003C\u002Fcode\u003E\u003C\u002Ffigcaption\u003E\u003C\u002Fdiv\u003E\u003C\u002Ffigure\u003E\u003Cp\u003E\u003Ccode\u003EKotlinMultiplatformExtension\u003C\u002Fcode\u003E мы можем добыть уже знакомым нам способом через поиск в \u003Ccode\u003EProject.extensions\u003C\u002Fcode\u003E. Возвращаемся в файл \u003Ccode\u003EBaseExtensions.kt\u003C\u002Fcode\u003E и пишем:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"kotlin\"\u003Efun Project.kotlinAndroidTarget(block: KotlinAndroidTarget.() -&gt; Unit) {\n    extensions.findByType(KotlinMultiplatformExtension::class)\n\t    ?.androidTarget(block)\n\t    ?: error(\"Kotlin multiplatform was not been added\")\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EДалее идем в файл \u003Ccode\u003Eandroid.base.test.config.gradle.kts\u003C\u002Fcode\u003E и конфигурируем тесты с помощью написанного нами Extension \u003Ccode\u003EProject.kotlinAndroidTarget\u003C\u002Fcode\u003E. В процессе видим, что при настройке \u003Ccode\u003EinstrumentedTestVariant\u003C\u002Fcode\u003E в блоке \u003Ccode\u003Edependencies\u003C\u002Fcode\u003E недоступны функции \u003Ccode\u003Eimplementation\u003C\u002Fcode\u003E\u002F\u003Ccode\u003EdebugImplementation\u003C\u002Fcode\u003E.\u003C\u002Fp\u003E\u003Cfigure class=\"full-width \"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw1560\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F4d0\u002F3a0\u002Fe1f\u002F4d03a0e1fded8cdf2c18fc891eefb35c.png\" alt=\"Нет доступа к implementation\u002FdebugImplementation\" title=\"Нет доступа к implementation\u002FdebugImplementation\" width=\"1377\" height=\"630\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F4d0\u002F3a0\u002Fe1f\u002F4d03a0e1fded8cdf2c18fc891eefb35c.png\"\u002F\u003E\u003Cdiv\u003E\u003Cfigcaption\u003EНет доступа к \u003Ccode\u003Eimplementation\u003C\u002Fcode\u003E\u002F\u003Ccode\u003EdebugImplementation\u003C\u002Fcode\u003E\u003C\u002Ffigcaption\u003E\u003C\u002Fdiv\u003E\u003C\u002Ffigure\u003E\u003Cp\u003EВ этом случае мы пишем очередные Extensions! Для этого создадим отдельный файл \u003Ccode\u003EDependenciesExtensions.kt\u003C\u002Fcode\u003E, т. к. он пригодится нам дальше, и пишем следующие функции:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"kotlin\"\u003Epackage io.github.dmitriy1892.conventionplugins.base.extensions\n \nimport org.gradle.api.artifacts.MinimalExternalModuleDependency\nimport org.gradle.api.provider.Provider import org.gradle.kotlin.dsl.DependencyHandlerScope\n \nfun DependencyHandlerScope.implementation( dependency: Provider ) {\n    add(\"implementation\", dependency)\n}\n \nfun DependencyHandlerScope.debugImplementation( dependency: Provider ) {\n    add(\"debugImplementation\", dependency)\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EПрименяем это в файле \u003Ccode\u003Eandroid.base.test.config.gradle.kts\u003C\u002Fcode\u003E, также заполняем другие данные для плагина теста. Получаем такой вид:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"kotlin\"\u003Eimport com.android.build.api.dsl.ManagedVirtualDevice\nimport io.github.dmitriy1892.conventionplugins.base.extensions.androidConfig\nimport io.github.dmitriy1892.conventionplugins.base.extensions.debugImplementation\nimport io.github.dmitriy1892.conventionplugins.base.extensions.implementation\nimport io.github.dmitriy1892.conventionplugins.base.extensions.kotlinAndroidTarget\nimport io.github.dmitriy1892.conventionplugins.base.extensions.libs\nimport org.jetbrains.kotlin.gradle.plugin.KotlinSourceSetTree\n \nkotlinAndroidTarget {\n    instrumentedTestVariant {\n\t    sourceSetTree.set(KotlinSourceSetTree.test)\n \n\t    dependencies {\n\t        debugImplementation(libs.androidx.testManifest)\n\t        implementation(libs.androidx.junit4)\n\t    }\n    }\n}\n \nandroidConfig {\n    defaultConfig {\n\t    testInstrumentationRunner = \"androidx.test.runner.AndroidJUnitRunner\"\n    }\n \n    \u002F\u002Fhttps:\u002F\u002Fdeveloper.android.com\u002Fstudio\u002Ftest\u002Fgradle-managed-devices\n    @Suppress(\"UnstableApiUsage\")\n    testOptions {\n\t    managedDevices.devices {\n\t        maybeCreate&lt;ManagedVirtualDevice&gt;(\"pixel5\").apply {\n\t            device = \"Pixel 5\"\n\t            apiLevel = libs.versions.targetSdk.get().toInt()\n\t            systemImageSource = \"aosp\"\n\t        }\n\t    }\n    }\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EПрименяем наш новосозданный плагин в \u003Ccode\u003Ebuild.gradle.kts\u003C\u002Fcode\u003E-файлах модулей проекта и удаляем обобщенные в плагине блоки.\u003C\u002Fp\u003E\u003Cfigure class=\"full-width \"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw1560\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F4ab\u002Fcb9\u002F6e5\u002F4abcb96e5f523711de6eb4f5088627ed.png\" alt=\"Добавление плагина тестов и удаление обобщенных скриптов\" title=\"Добавление плагина тестов и удаление обобщенных скриптов\" width=\"1600\" height=\"885\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F4ab\u002Fcb9\u002F6e5\u002F4abcb96e5f523711de6eb4f5088627ed.png\"\u002F\u003E\u003Cdiv\u003E\u003Cfigcaption\u003EДобавление плагина тестов и удаление обобщенных скриптов\u003C\u002Ffigcaption\u003E\u003C\u002Fdiv\u003E\u003C\u002Ffigure\u003E\u003Cfigure class=\"full-width \"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw1560\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fb7a\u002F5e1\u002Fa17\u002Fb7a5e1a17b1c4f710ef2cafab9c8fb56.png\" alt=\"Удаление обобщенных тестовых скриптов из android-блока\" title=\"Удаление обобщенных тестовых скриптов из android-блока\" width=\"1600\" height=\"969\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fb7a\u002F5e1\u002Fa17\u002Fb7a5e1a17b1c4f710ef2cafab9c8fb56.png\"\u002F\u003E\u003Cdiv\u003E\u003Cfigcaption\u003EУдаление обобщенных тестовых скриптов из android-блока\u003C\u002Ffigcaption\u003E\u003C\u002Fdiv\u003E\u003C\u002Ffigure\u003E\u003Cp\u003EСинхронизируемся, проверяем, что наш мультиплатформенный тест работает с помощью команды \u003Ccode\u003E.\u002Fgradlew :composeApp:connectedAndroidTest\u003C\u002Fcode\u003E, и видим, что все успешно. Почему не напрямую делаем Run Test из UI для android-таргета — потому что \u003Ca href=\"https:\u002F\u002Fwww.jetbrains.com\u002Fhelp\u002Fkotlin-multiplatform-dev\u002Fcompose-test.html#28a09030:~:text=)%0A%20%20%20%20%7D%0A%7D-,To%20run%20tests%3A,-iOS%20Simulator\"\u003E\u003Cu\u003Eэто не работает в KMP.\u003C\u002Fu\u003E\u003C\u002Fa\u003E\u003C\u002Fp\u003E\u003Cp\u003EВынесем в Convention Plugin логику конфигурации мультиплатформенного проекта — подключение плагина и добавление таргетов, под которые собирается проект. Создаем файл \u003Ccode\u003Ekmp.base.config.gradle.kts\u003C\u002Fcode\u003E и наполняем:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"kotlin\"\u003Eplugins {\n    id(\"org.jetbrains.kotlin.multiplatform\")\n}\n \nkotlin {\n    androidTarget()\n \n    jvm()\n \n    iosX64()\n    iosArm64()\n    iosSimulatorArm64()\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EВынесем логику для упаковки iOS Framework в отдельный Extension. Для этого выделим получение \u003Ccode\u003EKotlinMultiplatformExtension\u003C\u002Fcode\u003E в отдельный Extension и заодно отрефакторим функцию \u003Ccode\u003EkotlinAndroidTarget\u003C\u002Fcode\u003E:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"kotlin\"\u003Efun Project.kotlinMultiplatformConfig(block: KotlinMultiplatformExtension.() -&gt; Unit) {\n    extensions.findByType&lt;KotlinMultiplatformExtension&gt;()\n\t    ?.apply(block)\n\t    ?: error(\"Kotlin multiplatform was not been added\")\n}\n \nfun Project.kotlinAndroidTarget(block: KotlinAndroidTarget.() -&gt; Unit) {\n    kotlinMultiplatformConfig {\n\t    androidTarget(block)\n    }\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EДалее создадим файл \u003Ccode\u003EIosExtensions.kt\u003C\u002Fcode\u003E и пропишем:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"kotlin\"\u003Epackage io.github.dmitriy1892.conventionplugins.base.extensions\n \nimport org.gradle.api.Project\nimport org.jetbrains.kotlin.gradle.plugin.mpp.Framework\nimport org.jetbrains.kotlin.gradle.plugin.mpp.KotlinNativeTarget\n \nfun Project.iosRegularFramework(\n    block: Framework.() -&gt; Unit\n) {\n    kotlinMultiplatformConfig {\n\t    targets\n\t        .filterIsInstance&lt;KotlinNativeTarget&gt;()\n\t        .forEach { nativeTarget -&gt; nativeTarget.binaries.framework(configure = block) }\n    }\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EТеперь можем применить плагин и Extension в наших \u003Ccode\u003Ebuild.gradle.kts\u003C\u002Fcode\u003E-файлах:\u003C\u002Fp\u003E\u003Cfigure class=\"full-width \"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw1560\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fdf5\u002Fc33\u002Fb15\u002Fdf5c33b15adde3034f2e61ae6d7ad274.png\" alt=\"Применение плагина kmp.base.config\" title=\"Применение плагина kmp.base.config\" width=\"1600\" height=\"829\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fdf5\u002Fc33\u002Fb15\u002Fdf5c33b15adde3034f2e61ae6d7ad274.png\"\u002F\u003E\u003Cdiv\u003E\u003Cfigcaption\u003EПрименение плагина \u003Ccode\u003Ekmp.base.config\u003C\u002Fcode\u003E\u003C\u002Ffigcaption\u003E\u003C\u002Fdiv\u003E\u003C\u002Ffigure\u003E\u003Cfigure class=\"full-width \"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw1560\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fe24\u002F1ce\u002Ff83\u002Fe241cef83b68ef0cf70545fce2eee3f7.png\" alt=\"Добавление Extension iosRegularFramework\" title=\"Добавление Extension iosRegularFramework\" width=\"1600\" height=\"345\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fe24\u002F1ce\u002Ff83\u002Fe241cef83b68ef0cf70545fce2eee3f7.png\"\u002F\u003E\u003Cdiv\u003E\u003Cfigcaption\u003EДобавление Extension \u003Ccode\u003EiosRegularFramework\u003C\u002Fcode\u003E\u003C\u002Ffigcaption\u003E\u003C\u002Fdiv\u003E\u003C\u002Ffigure\u003E\u003Ch2\u003EЧто мы можем еще улучшить\u003C\u002Fh2\u003E\u003Cp\u003EВзглянем на блок с зависимостями, объявляемыми для всех таргетов:\u003C\u002Fp\u003E\u003Cfigure class=\"full-width \"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw1560\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F10f\u002Fe48\u002F7e4\u002F10fe487e4328b667e4c97f1b3c08f2f2.png\" alt=\"Стандартное объявление зависимостей в KMP\" title=\"Стандартное объявление зависимостей в KMP\" width=\"1183\" height=\"1600\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F10f\u002Fe48\u002F7e4\u002F10fe487e4328b667e4c97f1b3c08f2f2.png\"\u002F\u003E\u003Cdiv\u003E\u003Cfigcaption\u003EСтандартное объявление зависимостей в KMP\u003C\u002Ffigcaption\u003E\u003C\u002Fdiv\u003E\u003C\u002Ffigure\u003E\u003Cp\u003EВидим Callback Hell из функций \u003Ccode\u003Ekotlin { sourceSets { &lt;target&gt;.dependencies { implementation(...) } } }\u003C\u002Fcode\u003E — выглядит не очень. Можем попробовать улучшить положение через объявление в блоке \u003Ccode\u003Edependencies\u003C\u002Fcode\u003E на уровне файла.\u003C\u002Fp\u003E\u003Cfigure class=\"full-width \"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw1560\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fdfd\u002F7ac\u002Fe76\u002Fdfd7ace76293eda1a2c90156d0341b20.png\" alt=\"Попытка объявления зависимостей в верхнеуровневом блоке dependencies\" title=\"Попытка объявления зависимостей в верхнеуровневом блоке dependencies\" width=\"1455\" height=\"1371\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fdfd\u002F7ac\u002Fe76\u002Fdfd7ace76293eda1a2c90156d0341b20.png\"\u002F\u003E\u003Cdiv\u003E\u003Cfigcaption\u003EПопытка объявления зависимостей в верхнеуровневом блоке \u003Ccode\u003Edependencies\u003C\u002Fcode\u003E\u003C\u002Ffigcaption\u003E\u003C\u002Fdiv\u003E\u003C\u002Ffigure\u003E\u003Cp\u003EДалеко не все таргеты доступны в этом блоке, да и каша из объявлений зависимостей между таргетами при таком подходе неизбежна на дистанции. \u003C\u002Fp\u003E\u003Cp\u003EКак улучшить положение? Конечно же, написать очередную пачку удобных Extensions.  Создадим новый файл \u003Ccode\u003EKmpDependenciesExtensions.kt\u003C\u002Fcode\u003E и пропишем:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"kotlin\"\u003Epackage io.github.dmitriy1892.conventionplugins.base.extensions\n \nimport org.gradle.api.Project\nimport org.jetbrains.kotlin.gradle.plugin.KotlinDependencyHandler\n \nfun Project.commonMainDependencies(block: KotlinDependencyHandler.() -&gt; Unit) {\n    kotlinMultiplatformConfig {\n\t    sourceSets.commonMain.dependencies(block)\n    }\n}\n \nfun Project.commonTestDependencies(block: KotlinDependencyHandler.() -&gt; Unit) {\n    kotlinMultiplatformConfig {\n\t    sourceSets.commonTest.dependencies(block)\n    }\n}\n \nfun Project.androidMainDependencies(block: KotlinDependencyHandler.() -&gt; Unit) {\n    kotlinMultiplatformConfig {\n\t    sourceSets.androidMain.dependencies(block)\n    }\n}\n \nfun Project.jvmMainDependencies(block: KotlinDependencyHandler.() -&gt; Unit) {\n    kotlinMultiplatformConfig {\n\t    sourceSets.jvmMain.dependencies(block)\n    }\n}\n \nfun Project.iosMainDependencies(block: KotlinDependencyHandler.() -&gt; Unit) {\n    kotlinMultiplatformConfig {\n\t    sourceSets.iosMain.dependencies(block)\n    }\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EПрименяем Extensions в \u003Ccode\u003Ebuild.gradle.kts\u003C\u002Fcode\u003E-файлах:\u003C\u002Fp\u003E\u003Cfigure class=\"full-width \"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw1560\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fd4b\u002Fb87\u002F188\u002Fd4bb87188dc8dfdc68fa5545fa72adfc.png\" alt=\"Применение extension-функций для объявления зависимостей на уровне файла\" title=\"Применение extension-функций для объявления зависимостей на уровне файла\" width=\"1600\" height=\"965\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fd4b\u002Fb87\u002F188\u002Fd4bb87188dc8dfdc68fa5545fa72adfc.png\"\u002F\u003E\u003Cdiv\u003E\u003Cfigcaption\u003EПрименение extension-функций для объявления зависимостей на уровне файла\u003C\u002Ffigcaption\u003E\u003C\u002Fdiv\u003E\u003C\u002Ffigure\u003E\u003Cp\u003EВидим, что зависимости compose покраснели — произошло это потому, что зависимости на compose-библиотеки лежат \u003Cabbr class=\"habraabbr\" title=\"org.jetbrains.compose.ComposePlugin\" data-title=\"&lt;p&gt;org.jetbrains.compose.ComposePlugin&lt;\u002Fp&gt;&lt;p&gt;&lt;\u002Fp&gt;\" data-abbr=\"в недрах Compose Multiplatform Plugin\"\u003Eв недрах Compose Multiplatform Plugin\u003C\u002Fabbr\u003E, а не в Version Catalog, и при вынесении зависимостей в наши extension-функции перестал быть виден контекст \u003Ccode\u003Eorg.jetbrains.compose.ComposePlugin\u003C\u002Fcode\u003E. Но это не страшно, т. к. мы будем выносить конфигурацию compose в отдельный плагин, чем и займемся.\u003C\u002Fp\u003E\u003Cp\u003EСконфигурируем android-таргет. Для этого создадим файл \u003Ccode\u003Eandroid.compose.config.gradle.kts\u003C\u002Fcode\u003E и наполним:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"kotlin\"\u003Eimport io.github.dmitriy1892.conventionplugins.base.extensions.androidConfig\n \nplugins {\n    id(\"android.base.config\")\n}\n \n \nandroidConfig {\n    buildFeatures {\n\t    \u002F\u002Fenables a Compose tooling support in the AndroidStudio\n\t    compose = true\n    }\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EТакже создаем файл \u003Ccode\u003Ekmp.compose.config.gradle.kts\u003C\u002Fcode\u003E и наполняем:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"kotlin\"\u003Eimport io.github.dmitriy1892.conventionplugins.base.extensions.libs\n \nplugins {\n    id(\"org.jetbrains.kotlin.plugin.compose\")\n    id(\"org.jetbrains.compose\")\n \n    id(\"kmp.base.config\")\n    id(\"android.compose.config\")\n}\n \nkotlin {\n    sourceSets {\n\t    commonMain.dependencies {\n\t        implementation(compose.runtime)\n\t        implementation(compose.foundation)\n\t        implementation(compose.material3)\n\t        implementation(compose.components.resources)\n\t        implementation(compose.components.uiToolingPreview)\n\t    }\n \n\t    commonTest.dependencies {\n\t        implementation(kotlin(\"test\"))\n\t        @OptIn(org.jetbrains.compose.ExperimentalComposeLibrary::class)\n\t        implementation(compose.uiTest)\n\t    }\n \n\t    androidMain.dependencies {\n\t        implementation(compose.uiTooling)\n\t        implementation(libs.androidx.activityCompose)\n\t    }\n \n\t    jvmMain.dependencies {\n\t        implementation(compose.desktop.currentOs)\n\t    }\n    }\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EВ плагине \u003Ccode\u003Eandroid.compose.config.gradle.kts\u003C\u002Fcode\u003E мы применили \u003Ccode\u003Eandroid.base.config\u003C\u002Fcode\u003E, а в плагине \u003Ccode\u003Ekmp.compose.config.gradle.kts\u003C\u002Fcode\u003E — и \u003Ccode\u003Eandroid.compose.config.gradle.kts\u003C\u002Fcode\u003E, и \u003Ccode\u003Ekmp.base.config\u003C\u002Fcode\u003E. Соответственно, их можно убрать из \u003Ccode\u003Ebuild.gradle.kts\u003C\u002Fcode\u003E-файлов, если подключить туда один наш плагин \u003Ccode\u003Ekmp.compose.config.gradle.kts\u003C\u002Fcode\u003E, что и сделаем.\u003C\u002Fp\u003E\u003Cfigure class=\"full-width \"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw1560\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F987\u002F904\u002Ffab\u002F987904fab133374e7431ec1b0afcb1cd.png\" alt=\"Применение kmp.compose.config-плагина\" title=\"Применение kmp.compose.config-плагина\" width=\"1600\" height=\"955\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F987\u002F904\u002Ffab\u002F987904fab133374e7431ec1b0afcb1cd.png\"\u002F\u003E\u003Cdiv\u003E\u003Cfigcaption\u003EПрименение \u003Ccode\u003Ekmp.compose.config\u003C\u002Fcode\u003E-плагина\u003C\u002Ffigcaption\u003E\u003C\u002Fdiv\u003E\u003C\u002Ffigure\u003E\u003Cfigure class=\"full-width \"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw1560\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F0f0\u002Fe8f\u002F849\u002F0f0e8f8499fbb080fe359f6a287560c6.png\" alt=\"Применение kmp.compose.config-плагина\" title=\"Применение kmp.compose.config-плагина\" width=\"1600\" height=\"975\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F0f0\u002Fe8f\u002F849\u002F0f0e8f8499fbb080fe359f6a287560c6.png\"\u002F\u003E\u003Cdiv\u003E\u003Cfigcaption\u003EПрименение \u003Ccode\u003Ekmp.compose.config\u003C\u002Fcode\u003E-плагина\u003C\u002Ffigcaption\u003E\u003C\u002Fdiv\u003E\u003C\u002Ffigure\u003E\u003Cp\u003EСинхронизируем проект, проверяем, что все собралось.\u003C\u002Fp\u003E\u003Chr\u002F\u003E\u003Cp\u003EПодведем промежуточные итоги. Исходный \u003Ccode\u003Ebuild.gradle.kts\u003C\u002Fcode\u003E-файл в модуле \u003Ccode\u003EcomposeApp\u003C\u002Fcode\u003E занимал 143 строчки кода. Теперь же он уменьшился до 74 строк кода —  практически в 2 раза. Вполне себе неплохо. Но это еще не предел. Идем к светлому будущему — следующему разделу: \u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompanies\u002Ftbank\u002Farticles\u002F843786\u002F\"\u003Eсозданию Convention Plugins в kotlin-файлах и их регистрации для дальнейшего переиспользования\u003C\u002Fa\u003E.\u003C\u002Fp\u003E\u003Cp\u003E\u003C\u002Fp\u003E\u003C\u002Fdiv\u003E","tags":[{"titleHtml":"Gradle Convention Plugins"},{"titleHtml":"Gradle"},{"titleHtml":"Kotlin"},{"titleHtml":"Android"},{"titleHtml":"Kotlin Multiplatform"}],"metadata":{"stylesUrls":[],"scriptUrls":[],"shareImageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F5db\u002Fb11\u002Fe8b\u002F5dbb11e8b34998877497f928b873049a.jpg","shareImageWidth":1200,"shareImageHeight":630,"vkShareImageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F5db\u002Fb11\u002Fe8b\u002F5dbb11e8b34998877497f928b873049a.jpg","schemaJsonLd":"{\"@context\":\"http:\\\u002F\\\u002Fschema.org\",\"@type\":\"Article\",\"mainEntityOfPage\":{\"@type\":\"WebPage\",\"@id\":\"https:\\\u002F\\\u002Fhabr.com\\\u002Fru\\\u002Fcompanies\\\u002Ftbank\\\u002Farticles\\\u002F843662\\\u002F\"},\"headline\":\"Создание плагинов и переиспользуемых частей в .gradle.kts-файлах и Kotlin extension-функциях\",\"datePublished\":\"2024-09-19T10:20:51+03:00\",\"dateModified\":\"2024-09-27T11:57:14+03:00\",\"author\":{\"@type\":\"Person\",\"name\":\"Дмитрий\"},\"publisher\":{\"@type\":\"Organization\",\"name\":\"Habr\",\"logo\":{\"@type\":\"ImageObject\",\"url\":\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fa_\\\u002Flk\\\u002F9m\\\u002Fa_lk9mjkccjox-zccjrpfolmkmq.png\"}},\"description\":\"Всем привет! На связи Дима Котиков, и мы продолжаем разговор о том, как облегчить себе жизнь и уменьшить Boilerplate в gradle-файлах. В первой части поговорили о...\",\"url\":\"https:\\\u002F\\\u002Fhabr.com\\\u002Fru\\\u002Fcompanies\\\u002Ftbank\\\u002Farticles\\\u002F843662\\\u002F#post-content-body\",\"about\":[\"c_tbank\",\"h_android_dev\",\"h_kotlin\",\"h_gradle\",\"f_develop\"],\"image\":[\"https:\\\u002F\\\u002Fhabr.com\\\u002Fshare\\\u002Fpublication\\\u002F843662\\\u002Fdbfb4b274acfbfd2a8790ea6053ec5bc\\\u002F\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002Fd29\\\u002F4ab\\\u002F179\\\u002Fd294ab179d9d24fe32e62ca32ea1d55f.jpg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002F7ac\\\u002F297\\\u002Ffd1\\\u002F7ac297fd1b3a47247b11ba16145a2b14.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002Ff07\\\u002F5f6\\\u002F218\\\u002Ff075f6218a724ecc783568074bf2ec04.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002F128\\\u002F329\\\u002F864\\\u002F1283298641429445bee06321cd640616.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002F67e\\\u002F6b6\\\u002F5af\\\u002F67e6b65afa6ff4c88ce317f7294e02b3.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002F72d\\\u002F8a7\\\u002Fab8\\\u002F72d8a7ab8a7f76683b75c3a940d3fbad.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002F7eb\\\u002F187\\\u002F480\\\u002F7eb187480038e6156bc791ff01a0404e.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002Fcc8\\\u002F0a7\\\u002Fc67\\\u002Fcc80a7c67ea0d645da20e2aa55ba6e18.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002F215\\\u002F080\\\u002F76b\\\u002F21508076bf5dab60685506dcf5745281.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002F957\\\u002F9f2\\\u002F1cf\\\u002F9579f21cfaa6d2d8ecd5b7b5f3bb08da.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002F765\\\u002F38b\\\u002Fef0\\\u002F76538bef03ce53d2dd86ffca7587506f.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002F32a\\\u002F8a7\\\u002Fc7a\\\u002F32a8a7c7a958041bbf56798f91a44462.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002Fb63\\\u002F5da\\\u002F329\\\u002Fb635da32904c134daa0d4a7f13b566dc.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002F997\\\u002Fbee\\\u002Fdb6\\\u002F997beedb64e9c90ab23a028971be7c5f.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002Fe5b\\\u002F9e9\\\u002Fe04\\\u002Fe5b9e9e04fb4a57d33849ac092e6de9e.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002F426\\\u002F8a3\\\u002Fc9e\\\u002F4268a3c9e5ecb0a3ca7ce3d184f10f74.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002F4d0\\\u002F3a0\\\u002Fe1f\\\u002F4d03a0e1fded8cdf2c18fc891eefb35c.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002F4ab\\\u002Fcb9\\\u002F6e5\\\u002F4abcb96e5f523711de6eb4f5088627ed.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002Fb7a\\\u002F5e1\\\u002Fa17\\\u002Fb7a5e1a17b1c4f710ef2cafab9c8fb56.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002Fdf5\\\u002Fc33\\\u002Fb15\\\u002Fdf5c33b15adde3034f2e61ae6d7ad274.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002Fe24\\\u002F1ce\\\u002Ff83\\\u002Fe241cef83b68ef0cf70545fce2eee3f7.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002F10f\\\u002Fe48\\\u002F7e4\\\u002F10fe487e4328b667e4c97f1b3c08f2f2.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002Fdfd\\\u002F7ac\\\u002Fe76\\\u002Fdfd7ace76293eda1a2c90156d0341b20.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002Fd4b\\\u002Fb87\\\u002F188\\\u002Fd4bb87188dc8dfdc68fa5545fa72adfc.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002F987\\\u002F904\\\u002Ffab\\\u002F987904fab133374e7431ec1b0afcb1cd.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002F0f0\\\u002Fe8f\\\u002F849\\\u002F0f0e8f8499fbb080fe359f6a287560c6.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002F5db\\\u002Fb11\\\u002Fe8b\\\u002F5dbb11e8b34998877497f928b873049a.jpg\"]}","metaDescription":"Всем привет! На связи Дима Котиков, и мы продолжаем разговор о том, как облегчить себе жизнь и уменьшить Boilerplate в gradle-файлах. В первой части поговорили о том, как подготовиться к созданию...","mainImageUrl":null,"amp":true,"customTrackerLinks":[]},"polls":[],"commentsEnabled":{"status":true,"reason":null},"rulesRemindEnabled":false,"votesEnabled":true,"status":"published","plannedPublishTime":null,"checked":null,"hasPinnedComments":false,"format":"tutorial","banner":null,"multiwidget":null,"multiwidgetUuid":null,"readingTime":11,"complexity":"medium","isEditorial":false,"allowedFeatures":{"isTestTargetAllow":false}}},"articlesIds":{},"isLoading":false,"pagesCount":{},"route":{},"reasonsList":null,"postReasonsList":null,"view":"list","lastVisitedRoute":{},"ssrCommentsArticleIds":[""],"viewedPosts":[],"myFeedFilter":{"complexity":"all","score":"all","types":["articles","posts","news"]},"myFeedIsApplyFilters":false,"myFeedIsForce":false,"karma":{"userReasonsList":null}},"authorContribution":{"authors":{}},"betaTest":{"currentAnnouncement":null,"announcements":{},"announcementCards":null,"announcementComments":{},"announcementCommentThreads":{},"announcementCommentingStatuses":{},"archivedList":[]},"authorStatistics":{"articleRefs":{},"articleIds":{},"pagesCount":{},"route":{},"viewsCount":[],"maxStatsCount":{}},"career":{"seoLandings":[],"hubs":""},"comments":{"articleComments":{},"articlePinnedComments":{},"searchCommentsResults":null,"pagesCount":null,"commentAccess":{},"scrollParents":{},"pageArticleComments":{"lastViewedComment":0,"postId":null,"lastCommentTimestamp":"","moderated":[],"moderatedIds":[],"commentRoute":"","idempotenceKey":""}},"companies":{"companyRefs":{"tbank":{"alias":"tbank","imageUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fcompany\u002F67a\u002F1f6\u002Fe4d\u002F67a1f6e4dd9929d4fbb91d9c6ada568d.png","titleHtml":"Т-Банк","descriptionHtml":null,"relatedData":null,"statistics":{"subscribersCount":86196,"rating":665.31,"invest":null,"postsCount":567,"threadsCount":6,"newsCount":7,"vacanciesCount":44,"employeesCount":818,"careerRating":null},"foundationDate":{"year":"2005","month":"11","day":"18"},"location":{"city":null,"region":null,"country":{"id":"168","title":"Россия"}},"siteUrl":"https:\u002F\u002Fl.tbank.ru\u002Fit_at_t","staffNumber":"свыше 10 000 человек","registrationDate":"2011-10-26T13:45:16+00:00","representativeUser":null,"contacts":[],"settings":{"analyticsSettings":[{"type":"ga","trackingId":"UA-9110453-17"},{"type":"ym","trackingId":"96651920"}],"branding":{"imageUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fbranding\u002F659\u002F805\u002F1f9\u002F6598051f9c34160162a7c795e749026b.png","linkUrl":"https:\u002F\u002Fmeetup.tinkoff.ru\u002F?utm_source=habr&utm_medium=prt.fix&utm_campaign=meetup.all.habr_header","pixelUrl":null,"uuid":"0191e176-5b91-710d-9b8d-2d7f9e857158"},"status":"active","isStartup":false,"hasActivePolls":false,"shouldShowHabrAds":false},"metadata":{"titleHtml":"Т-Банк, Россия -  с 18 ноября 2005 г.","title":"Т-Банк, Россия -  с 18 ноября 2005 г.","keywords":["тестирование","frontend","scala","java","интеграционное тестирование","angular","playwright","ангуляр","digest","tbank","jdk","spring","kotlin","jep"],"descriptionHtml":"567 статей от авторов компании Т-Банк","description":"567 статей от авторов компании Т-Банк"},"aDeskSettings":null,"careerAlias":"tbank","schoolAlias":null}},"companyIds":{},"companyTopIds":{},"pagesCount":{},"companyProfiles":{},"companiesCategories":[],"companiesCategoriesTotalCount":0,"companiesWidgets":{},"companiesWorkers":{},"companiesFans":{},"multiwidgets":{},"route":{},"isLoading":false,"companyWorkersLoading":false,"companyFansLoading":false,"multiwidgetLoading":false,"vacancies":{},"companiesGalleries":{},"companiesBanners":{},"companiesLandingVacancies":{},"companiesTechnologies":{},"workplaceInfo":null},"companyAdmin":{"companyInfo":null,"companyInfoLoading":false,"faqArticles":null,"brandingPreviewImageUrl":null,"jivoStatus":0,"adminNotifications":null,"availableInvitesCount":{}},"companyAdd":{"currentStep":"","stepsData":{},"uncompletedSteps":[],"isStepLoading":true,"isStepCommitting":false,"isInitialized":false,"agreementContent":""},"companiesContribution":{"hubs":{},"flows":{},"companyRefs":{}},"companyHubsContribution":{"contributionRefs":{"hubRefs":{},"hubIds":{}}},"conversation":{"messages":[],"respondent":null,"isLoadMore":false},"conversations":{"conversations":[],"pagesCount":0},"docs":{"menu":{},"articles":{},"mainMenu":[],"loading":{"main":false,"dropdown":false,"article":false}},"feature":{"isProbablyVisible":true},"fixedBanner":{"isArticleStickyPanelVisible":false,"isArticleStickyPanelAtTheBottom":false,"isFixedBannerVisible":false,"isStickyPanelIconsHidden":false},"flows":{"flows":[{"id":"1","alias":"develop","title":"Разработка","titleHtml":"Разработка","route":{"name":"FLOW_PAGE","params":{"flowName":"develop"}}},{"id":"6","alias":"admin","title":"Администрирование","titleHtml":"Администрирование","route":{"name":"FLOW_PAGE","params":{"flowName":"admin"}}},{"id":"2","alias":"design","title":"Дизайн","titleHtml":"Дизайн","route":{"name":"FLOW_PAGE","params":{"flowName":"design"}}},{"id":"3","alias":"management","title":"Менеджмент","titleHtml":"Менеджмент","route":{"name":"FLOW_PAGE","params":{"flowName":"management"}}},{"id":"4","alias":"marketing","title":"Маркетинг","titleHtml":"Маркетинг","route":{"name":"FLOW_PAGE","params":{"flowName":"marketing"}}},{"id":"7","alias":"popsci","title":"Научпоп","titleHtml":"Научпоп","route":{"name":"FLOW_PAGE","params":{"flowName":"popsci"}}}],"updates":{}},"global":{"isPwa":false,"device":"mobile","isHabrCom":true,"requestId":"f019520d306ae739564d68edb539d462"},"hubs":{"hubRefs":{},"hubIds":{},"pagesCount":{},"isLoading":false,"route":{}},"hubsBlock":{"hubRefs":{},"hubIds":{}},"i18n":{"fl":"ru","hl":"ru"},"info":{"welcomePage":{},"isLoading":true},"location":{"urlStruct":{"protocol":null,"slashes":null,"auth":null,"host":null,"port":null,"hostname":null,"hash":null,"query":{},"pathname":"\u002Fru\u002Fcompanies\u002Ftbank\u002Farticles\u002F843662\u002F","path":"\u002Fru\u002Fcompanies\u002Ftbank\u002Farticles\u002F843662\u002F","href":"\u002Fru\u002Fcompanies\u002Ftbank\u002Farticles\u002F843662\u002F"}},"me":{"user":null,"uuid":null,"ppgDemanded":false,"karmaResetInfo":{"canReincarnate":null,"wasReincarnated":null,"currentScore":null},"notes":null,"userUpdates":{"feeds":{"newPostsCount":null,"newThreadsCount":null,"newNewsCount":null,"newCount":null},"conversationUnreadCount":0}},"mostReadingList":{"mostReadingListIds":[],"mostReadingListRefs":null,"promoPost":null},"onboarding":{"currentStep":null,"stepsData":{},"stepsErrors":{},"completedSteps":[],"isStepCommitting":false,"isCommitDisabled":true},"ppa":{"articles":{},"card":null,"transactions":null,"totalTransactions":null,"isAccessible":null},"projectsBlocks":{"activeBlocks":{"vacancies":"project-block-company-article"}},"promoData":{"isLoading":false,"hasLoaded":false,"featurer":null,"megaposts":null,"promoLinks":null,"promoPosts":null,"sticker":null},"publicationStatistics":{"statsInfo":{},"statsFunnels":{},"statsGraph":{},"defaultSuggest":{},"suggest":{},"timeTracker":{},"isTrackingActivity":false,"isUserActive":true,"otherPublicationStats":{}},"pullRefresh":{"shouldRefresh":false},"sandbox":{"articleIds":[],"articleRefs":{},"pagesCount":null,"route":{},"lastVisitedRoute":{},"isLoading":false},"search":{"searchQueryError":null},"settingsOther":{"inputs":{"uiLang":{"errors":[],"ref":null,"value":""},"articlesLangEnglish":{"errors":[],"ref":null,"value":false},"articlesLangRussian":{"errors":[],"ref":null,"value":false},"agreement":{"errors":[],"ref":null,"value":false},"email":{"errors":[],"ref":null,"value":true},"digest":{"errors":[],"ref":null,"value":true}}},"similarList":{"similarListIds":[],"similarListRefs":null},"ssr":{"error":null,"isDataLoaded":true,"isDataLoading":false,"isHydrationFailed":false,"isServer":false},"stories":{"stories":[{"id":"story-998","author":{"logo":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F91a\u002F166\u002F49f\u002F91a16649f9ef89302a5a56cfa22a451d.png","title":"Яндекс Практикум","link":"https:\u002F\u002Fu.habr.com\u002Fstories_up"},"title":"Как расти на работе?","lang":"ru","startTime":"2025-03-18T18:45:00+03:00","finishTime":"2025-03-31T19:00:00+03:00","slides":[{"id":"story-998_1","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fbf4\u002F911\u002F7e6\u002Fbf49117e637ff2099b3944f8803cd7a3.png","button":null},{"id":"story-998_2","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F3e3\u002Fc84\u002Fe83\u002F3e3c84e8330ea1ddf72e9d310457ed2f.png","button":{"title":"Расти в карьере","link":"https:\u002F\u002Fu.habr.com\u002Fstories_up","colorType":"light"}},{"id":"story-998_3","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F84b\u002F533\u002F3c3\u002F84b5333c3e77e8dac62a8b50d042acb9.png","button":{"title":"Расти в карьере","link":"https:\u002F\u002Fu.habr.com\u002Fstories_up","colorType":"light"}},{"id":"story-998_4","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F257\u002Feb0\u002F2be\u002F257eb02bea1777e13f3e647cae6e06cd.png","button":{"title":"Расти в карьере","link":"https:\u002F\u002Fu.habr.com\u002Fstories_up","colorType":"light"}},{"id":"story-998_5","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F858\u002F086\u002F0ed\u002F8580860ed3497c043c04f9a42054d74f.png","button":{"title":"Расти в карьере","link":"https:\u002F\u002Fu.habr.com\u002Fstories_up","colorType":"light"}},{"id":"story-998_6","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fcdf\u002F32f\u002F387\u002Fcdf32f38777f046c063b5182f4125e14.png","button":{"title":"Расти в карьере","link":"https:\u002F\u002Fu.habr.com\u002Fstories_up","colorType":"light"}},{"id":"story-998_7","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fd48\u002Ff2d\u002F0e2\u002Fd48f2d0e2ecd7d746d738191bb913d8f.png","button":{"title":"Расти в карьере","link":"https:\u002F\u002Fu.habr.com\u002Fstories_up","colorType":"light"}},{"id":"story-998_8","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fb38\u002Ffd7\u002Fee0\u002Fb38fd7ee04848bf3b058be7403438bd1.png","button":{"title":"Расти в карьере","link":"https:\u002F\u002Fu.habr.com\u002Fstories_up","colorType":"light"}},{"id":"story-998_9","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F79e\u002Feaa\u002F9d8\u002F79eeaa9d8af5a288ad42bd9d63b5793a.png","button":{"title":"Расти в карьере","link":"https:\u002F\u002Fu.habr.com\u002Fstories_up","colorType":"light"}},{"id":"story-998_10","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fcdc\u002F17e\u002F385\u002Fcdc17e38582dc67838b9abfb200d982e.png","button":{"title":"Расти в карьере","link":"https:\u002F\u002Fu.habr.com\u002Fstories_up","colorType":"light"}}]},{"id":"story-996","author":{"logo":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fe63\u002F36d\u002Fa24\u002Fe6336da24460ab6b9fbc347d03eb263a.png","title":"Хабр","link":null},"title":"Здоровье айтишника","lang":"ru","startTime":"2025-03-17T10:22:00+03:00","finishTime":"2025-04-13T10:22:00+03:00","slides":[{"id":"story-996_1","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fb7c\u002F6de\u002F8ea\u002Fb7c6de8ea6789dbc30f071716172b6dd.jpg","button":null},{"id":"story-996_2","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F2e7\u002F88a\u002F0fe\u002F2e788a0fe61729ca8b23eb59069c844f.jpg","button":{"title":"Личный опыт","link":"https:\u002F\u002Fu.habr.com\u002Fzd-1","colorType":"light"}},{"id":"story-996_3","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fb93\u002F6f4\u002F256\u002Fb936f425653b84fa60ab00d09f78c543.jpg","button":{"title":"Как это было","link":"https:\u002F\u002Fu.habr.com\u002Fzd-2","colorType":"light"}},{"id":"story-996_4","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fc10\u002Fd14\u002Ff5a\u002Fc10d14f5a4859fe10baecbcc2bcb8828.jpg","button":{"title":"Шея в фокусе","link":"https:\u002F\u002Fu.habr.com\u002Fzd-3","colorType":"dark"}},{"id":"story-996_5","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F535\u002Fe1b\u002F77a\u002F535e1b77a9eb896262ad73321f2ad99f.jpg","button":{"title":"Фотоинструкция","link":"https:\u002F\u002Fu.habr.com\u002Fzd-4","colorType":"light"}},{"id":"story-996_6","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F569\u002Fc39\u002F49f\u002F569c3949f5b330ea85d4a1864f481c3d.jpg","button":{"title":"Сидите (не)правильно","link":"https:\u002F\u002Fu.habr.com\u002Fzd-5","colorType":"dark"}},{"id":"story-996_7","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F1f2\u002F1de\u002Fdbf\u002F1f21dedbf2902bc4061a75b839b63595.jpg","button":{"title":"Журнал изменений","link":"https:\u002F\u002Fu.habr.com\u002Fzd-6","colorType":"dark"}},{"id":"story-996_8","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F95a\u002F164\u002F21b\u002F95a16421badc3a9f1135309ab0c42c41.jpg","button":{"title":"Альтернатива","link":"https:\u002F\u002Fu.habr.com\u002Fzd-7","colorType":"light"}},{"id":"story-996_9","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F624\u002F027\u002F54d\u002F62402754d311798af44bcfe7f9abfedc.jpg","button":{"title":"Хроника поисков","link":"https:\u002F\u002Fu.habr.com\u002Fzd-8","colorType":"dark"}}]},{"id":"story-992","author":{"logo":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F3fe\u002F2fc\u002Fb05\u002F3fe2fcb05df852d7e1e00d44e54e39ae.png","title":"Сезоны Хабра","link":"https:\u002F\u002Fu.habr.com\u002Ffnstories"},"title":"Угадайте будущее в новом сезоне","lang":"ru","startTime":"2025-03-12T19:15:00+03:00","finishTime":"2025-03-31T23:56:00+03:00","slides":[{"id":"story-992_1","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fc56\u002Faf5\u002Fc43\u002Fc56af5c4377f7f7b94f7b6ad20fc92c3.png","button":{"title":"А что за сезон?","link":"https:\u002F\u002Fu.habr.com\u002Ffnstories","colorType":"light"}},{"id":"story-992_2","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F8fa\u002Fde7\u002F65d\u002F8fade765d99207f31c597283ae6ce912.png","button":{"title":"Какие темы нужны","link":"https:\u002F\u002Fu.habr.com\u002Ffnstories","colorType":"dark"}},{"id":"story-992_3","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F23e\u002F7b9\u002Fb24\u002F23e7b9b24cb056d1a42e8d31ccea16ce.png","button":{"title":"Сезон будущего ИИ","link":"https:\u002F\u002Fu.habr.com\u002Ffnstories","colorType":"dark"}},{"id":"story-992_4","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F27b\u002Fbfc\u002Fa18\u002F27bbfca18e656ee0122b5cb8eb2cb502.png","button":{"title":"Все правила сезона","link":"https:\u002F\u002Fu.habr.com\u002Ffnstories","colorType":"dark"}},{"id":"story-992_5","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F1e0\u002F6c6\u002Ff33\u002F1e06c6f33e703bbd2b2ae3baee3376fd.png","button":{"title":"Как участвовать","link":"https:\u002F\u002Fu.habr.com\u002Ffnstories","colorType":"dark"}}]},{"id":"story-990","author":{"logo":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F282\u002Fe80\u002Fbf1\u002F282e80bf1b73484126ed53c6f3e42692.png","title":"Aeza","link":"https:\u002F\u002Fu.habr.com\u002FI72qi"},"title":"С праздником весны!","lang":"ru","startTime":"2025-03-09T10:15:00+03:00","finishTime":"2025-03-30T23:59:00+03:00","slides":[{"id":"story-990_1","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F064\u002F9dd\u002Ff59\u002F0649ddf5949cae6c9342fb62034a36ac.png","button":null},{"id":"story-990_2","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F05f\u002F96b\u002F25e\u002F05f96b25e910c32256ee0b1916f21380.png","button":{"title":"Семейная история","link":"https:\u002F\u002Fu.habr.com\u002Fey2bY","colorType":"light"}},{"id":"story-990_3","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fcd1\u002Ff5d\u002F921\u002Fcd1f5d921bb9489ac11727272660bdb6.png","button":{"title":"Движущиеся картинки","link":"https:\u002F\u002Fu.habr.com\u002FWLKXU","colorType":"light"}},{"id":"story-990_4","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fb55\u002Fd45\u002Fec5\u002Fb55d45ec50e53275c60d16ea886a0672.png","button":{"title":"Личный опыт","link":"https:\u002F\u002Fu.habr.com\u002FSxrki","colorType":"light"}},{"id":"story-990_5","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Ffa7\u002F1ce\u002Ffca\u002Ffa71cefca5ed0a3fe8b50bd703b3605f.png","button":{"title":"Алгоритм","link":"https:\u002F\u002Fu.habr.com\u002Ftbz2p","colorType":"light"}},{"id":"story-990_6","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F435\u002F89d\u002Ff90\u002F43589df9018846cc6a8eed986226b252.png","button":{"title":"Выбрать сценарий","link":"https:\u002F\u002Fu.habr.com\u002F0RCPk","colorType":"light"}},{"id":"story-990_7","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F514\u002F5f8\u002F619\u002F5145f86194ad48dad48a846b42af0f93.png","button":{"title":"Jiraзамещение","link":"https:\u002F\u002Fu.habr.com\u002FEwhYq","colorType":"light"}},{"id":"story-990_8","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F439\u002Fa83\u002Fae7\u002F439a83ae78f7ef711e3b9bbed1ec26c5.png","button":{"title":"8 вещей","link":"https:\u002F\u002Fu.habr.com\u002FVTv2r","colorType":"light"}},{"id":"story-990_9","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F02d\u002F783\u002F2f7\u002F02d7832f7b1c95d88bff9f34209e204a.png","button":{"title":"Интерфейсы","link":"https:\u002F\u002Fu.habr.com\u002FUFOMZ","colorType":"light"}},{"id":"story-990_10","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F0cb\u002Ff7f\u002F0d9\u002F0cbf7f0d905d486ce4ff82bc939b21d5.png","button":{"title":"Стикеры ваши","link":"https:\u002F\u002Fu.habr.com\u002FoA1K7","colorType":"light"}}]},{"id":"story-984","author":{"logo":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F648\u002F61b\u002F9ae\u002F64861b9aecb7c474cd94063f98045541.png","title":"Хабр","link":null},"title":"Всегда котов!","lang":"ru","startTime":"2025-03-01T00:01:09+03:00","finishTime":"2025-03-23T16:21:00+03:00","slides":[{"id":"story-984_1","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fc06\u002Fc21\u002F93f\u002Fc06c2193ff34362ac2af782cf2571f55.png","button":null},{"id":"story-984_2","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fb68\u002F15f\u002F763\u002Fb6815f7630b9c015b1e67efb5bdf12d4.jpg","button":{"title":"Сделать purrrr","link":"https:\u002F\u002Fu.habr.com\u002Fj4DN1","colorType":"light"}},{"id":"story-984_3","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F550\u002F76e\u002Fd7a\u002F55076ed7a0954e243f944fc2f330623a.png","button":{"title":"Тыгыдык","link":"https:\u002F\u002Fu.habr.com\u002Fya360_kotov","colorType":"dark"}},{"id":"story-984_4","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F2fb\u002F23b\u002F06c\u002F2fb23b06cf294c2050104b2aef589788.jpg","button":{"title":"Исследование","link":"https:\u002F\u002Fu.habr.com\u002FbO3r0","colorType":"light"}},{"id":"story-984_5","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Ff50\u002F50f\u002F0ae\u002Ff5050f0aeea1335c4f0544c1863f8342.jpg","button":{"title":"Детали проекта","link":"https:\u002F\u002Fu.habr.com\u002FQJmhe","colorType":"light"}},{"id":"story-984_6","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F825\u002F3dd\u002F5f5\u002F8253dd5f5c19dd061578f1d09310a45f.jpg","button":{"title":"Эксперименты","link":"https:\u002F\u002Fu.habr.com\u002FVaOdo","colorType":"light"}},{"id":"story-984_7","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F3fb\u002Fc92\u002F0f9\u002F3fbc920f9ea81eca2c1c027ff77fc659.jpg","button":{"title":"Это не мем","link":"https:\u002F\u002Fu.habr.com\u002F0Wb3p","colorType":"light"}},{"id":"story-984_8","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F2b4\u002F794\u002Fc33\u002F2b4794c33844e60aad9468018fd132cd.jpg","button":{"title":"В засаде","link":"https:\u002F\u002Fu.habr.com\u002FnasCD","colorType":"dark"}}]}]},"technotext":{"years":[],"technotextDocForNominees":null,"technotextDocForWinners":null,"technotextInfo":{},"technotextInfoLoading":false,"technotextWinners":{},"technotextWinnersLoading":false},"userHubsContribution":{"contributionRefs":{"hubRefs":{},"hubIds":{}}},"userInvites":{"availableInvites":0,"usedInvitesIds":[],"usedInvitesRefs":{},"usedInvitesPagesCount":0,"unusedInvitesIds":[],"unusedInvitesRefs":{},"unusedInvitesPagesCount":0},"userVotes":{"karmaVotesList":[],"karmaVotesPagesCount":null,"karmaVotesListLoading":false,"commentsVotesList":[],"commentsVotesPagesCount":null,"commentsVotesListLoading":false,"postsVotesList":[],"postsVotesPagesCount":null,"postsVotesListLoading":false,"userVotesList":[],"userVotesPagesCount":null,"userVotesListLoading":false},"users":{"authorRefs":{},"authorIds":{},"pagesCount":{},"authorProfiles":{"dkotikov":{"alias":"dkotikov","badgets":[{"title":"Захабренный","description":"Пользователь с кармой \u003E0","url":null,"isRemovable":false}],"aboutHtml":"","contacts":[],"invitedBy":{"issuerLogin":null,"timeCreated":"2024-09-16T08:56:37+00:00"},"careerProfile":null,"companies":{"pagesCount":1,"companyIds":["avito","dododev","habr","jugru","kts","kuper","magnit","microsoft","otus","rambler_and_co","samsung","sberbank","surfstudio","tbank","vivaldi","vk","yandex","yandex_praktikum"],"companyRefs":{"avito":{"id":"4486","alias":"avito","titleHtml":"AvitoTech","descriptionHtml":"У нас живут ваши объявления","imageUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fcompany\u002F7ba\u002F74f\u002Fb37\u002F7ba74fb3764caa1fb6865aaa6b6aa4bf.png","relatedData":null,"statistics":{"subscribersCount":166317,"rating":274.87,"invest":null},"commonHubs":[]},"dododev":{"id":"5678","alias":"dododev","titleHtml":"Dodo Engineering","descriptionHtml":"О том, как разработчики строят IT в Dodo","imageUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fcompany\u002Fc37\u002F86f\u002F1d7\u002Fc3786f1d732115828fc25720680f27d8.png","relatedData":null,"statistics":{"subscribersCount":102881,"rating":108.2,"invest":null},"commonHubs":[]},"habr":{"id":"412","alias":"habr","titleHtml":"Habr","descriptionHtml":"Create services for geeks","imageUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fcompany\u002F075\u002Fe25\u002Fe71\u002F075e25e71073e14733fe91726932789a.png","relatedData":null,"statistics":{"subscribersCount":155825,"rating":459.26,"invest":null},"commonHubs":[]},"jugru":{"id":"2192","alias":"jugru","titleHtml":"JUG Ru Group","descriptionHtml":"Конференции для Senior-разработчиков","imageUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fcompany\u002F0a7\u002Fce6\u002Fa86\u002F0a7ce6a86556ff20579e90e6b732e663.png","relatedData":null,"statistics":{"subscribersCount":93717,"rating":110.73,"invest":null},"commonHubs":[]},"kts":{"id":"7792","alias":"kts","titleHtml":"KTS","descriptionHtml":"Создаем цифровые продукты для бизнеса","imageUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fcompany\u002Fcc2\u002Fc99\u002F64b\u002Fcc2c9964bc4927b7001827fc0b2b471b.png","relatedData":null,"statistics":{"subscribersCount":39444,"rating":238.52,"invest":null},"commonHubs":[]},"kuper":{"id":"6692","alias":"kuper","titleHtml":"Купер","descriptionHtml":"Кодим будущее доставки товаров","imageUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fcompany\u002Feff\u002F2d7\u002F9bb\u002Feff2d79bbfb76fce8ece671ee083a035.png","relatedData":null,"statistics":{"subscribersCount":44470,"rating":75.21,"invest":null},"commonHubs":[]},"magnit":{"id":"7876","alias":"magnit","titleHtml":"Magnit Tech","descriptionHtml":"Соединяем IT и ритейл","imageUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fcompany\u002F851\u002Fb43\u002Fcbd\u002F851b43cbdf68b08b04a28fb477dcfae2.jpg","relatedData":null,"statistics":{"subscribersCount":16909,"rating":96.41,"invest":null},"commonHubs":[]},"microsoft":{"id":"68","alias":"microsoft","titleHtml":"Microsoft","descriptionHtml":"Microsoft — мировой лидер в области ПО и ИТ-услуг","imageUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fcompany\u002Fe98\u002F5cf\u002F6a0\u002Fe985cf6a01b15006350561f26c70a41f.png","relatedData":null,"statistics":{"subscribersCount":163238,"rating":0,"invest":null},"commonHubs":[]},"otus":{"id":"4756","alias":"otus","titleHtml":"OTUS","descriptionHtml":"Цифровые навыки от ведущих экспертов","imageUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fcompany\u002Fa65\u002F525\u002F4fe\u002Fa655254feebb0b25a027b5e276ea6489.png","relatedData":null,"statistics":{"subscribersCount":158808,"rating":714.96,"invest":null},"commonHubs":[]},"rambler_and_co":{"id":"3339","alias":"rambler_and_co","titleHtml":"Rambler&Co","descriptionHtml":null,"imageUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fcompany\u002F40e\u002Fcad\u002F523\u002F40ecad523a093575527c3c3292c6b5d8.jpg","relatedData":null,"statistics":{"subscribersCount":79165,"rating":58.48,"invest":null},"commonHubs":[]},"samsung":{"id":"950","alias":"samsung","titleHtml":"Samsung","descriptionHtml":null,"imageUrl":null,"relatedData":null,"statistics":{"subscribersCount":38794,"rating":75.65,"invest":null},"commonHubs":[]},"sberbank":{"id":"1272","alias":"sberbank","titleHtml":"Сбер","descriptionHtml":"Больше чем банк","imageUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fcompany\u002F0dd\u002Fcfc\u002Ff94\u002F0ddcfcf9441f7977e9841a2010376271.jpg","relatedData":null,"statistics":{"subscribersCount":133262,"rating":630.49,"invest":null},"commonHubs":[]},"surfstudio":{"id":"5760","alias":"surfstudio","titleHtml":"Surf","descriptionHtml":"Создаём веб- и мобильные приложения","imageUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fcompany\u002Fcac\u002F579\u002F907\u002Fcac5799077a2883e001815819c2ccbac.jpg","relatedData":null,"statistics":{"subscribersCount":37557,"rating":138.19,"invest":null},"commonHubs":[]},"tbank":{"id":"1544","alias":"tbank","titleHtml":"Т-Банк","descriptionHtml":null,"imageUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fcompany\u002F67a\u002F1f6\u002Fe4d\u002F67a1f6e4dd9929d4fbb91d9c6ada568d.png","relatedData":null,"statistics":{"subscribersCount":86196,"rating":665.31,"invest":null},"commonHubs":[]},"vivaldi":{"id":"3271","alias":"vivaldi","titleHtml":"Vivaldi Technologies AS","descriptionHtml":"Vivaldi — браузер для наших друзей","imageUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fcompany\u002F815\u002F3e5\u002F43d\u002F8153e543d9fe0694c86f028e20216a09.png","relatedData":null,"statistics":{"subscribersCount":52852,"rating":44.02,"invest":null},"commonHubs":[]},"vk":{"id":"2","alias":"vk","titleHtml":"VK","descriptionHtml":"Building the Internet","imageUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fcompany\u002F4b6\u002Fb3a\u002F7f0\u002F4b6b3a7f070b96467c0b0f15c3159fa8.png","relatedData":null,"statistics":{"subscribersCount":234311,"rating":294.89,"invest":null},"commonHubs":[]},"yandex":{"id":"1","alias":"yandex","titleHtml":"Яндекс","descriptionHtml":"Как мы делаем Яндекс","imageUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fcompany\u002Fb02\u002Fd9b\u002F1d4\u002Fb02d9b1d4a6e64ff069e2ab32fdedae2.png","relatedData":null,"statistics":{"subscribersCount":239643,"rating":709.92,"invest":null},"commonHubs":[]},"yandex_praktikum":{"id":"7694","alias":"yandex_praktikum","titleHtml":"Яндекс Практикум","descriptionHtml":"Помогаем людям расти","imageUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fcompany\u002Fefc\u002F896\u002Fec9\u002Fefc896ec91620ce506267a64312c6f41.png","relatedData":null,"statistics":{"subscribersCount":97051,"rating":99.71,"invest":null},"commonHubs":[]}}}}},"userHubs":{},"userInvitations":{},"authorFollowers":{},"authorFollowed":{},"userSpecialization":{},"karmaStats":[],"statistics":null,"isLoading":false,"authorFollowersLoading":false,"authorFollowedLoading":false,"userHubsLoading":false,"userInvitationsLoading":false,"route":{}},"viewport":{"prevScrollY":{},"scrollY":0,"width":0},"tracker":{"notificationsLoading":false,"notificationsList":[],"notificationsPageCount":0,"pendingMarkNotificationsRead":[],"publicationsLoading":true,"publicationsList":[],"publicationsPageCount":0,"pendingDeletePublications":false,"pendingMarkPublicationsRead":false},"events":{"eventRefs":{},"eventIds":[],"pagesCount":0,"categories":[],"cities":[],"actualEvents":null,"currentEvent":null,"eventsFilter":{"city":"all","timeStarted":null,"timeEnded":null}},"wysiwyg":{"WYSIWYGRulesRefs":null}};(function(){var s;(s=document.currentScript||document.scripts[document.scripts.length-1]).parentNode.removeChild(s);}());</script><script src="https://assets.habr.com/habr-web/js/chunk-vendors.3b11d41f.js" defer></script><script src="https://assets.habr.com/habr-web/js/app.7a97ea6d.js" defer></script></div>
    <div id="overlays"><!----><!--teleport anchor--><!----><!--teleport anchor--><!----><!--teleport anchor--><!----><!--teleport anchor--><!----><!--teleport anchor--><!----><!--teleport anchor--></div>
    
    
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-S28W1WC23F"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
    </script>
  
  <script type="text/javascript" >
    (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
    m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
    (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");

  </script>
    <script type="text/javascript">
      window.addEventListener('load', function () {
        setTimeout(() => {
          const img = new Image();
          img.src = 'https://vk.com/rtrg?p=VK-RTRG-421343-57vKE';
        }, 0);
      });
    </script>
  
    </body>

    </html>
